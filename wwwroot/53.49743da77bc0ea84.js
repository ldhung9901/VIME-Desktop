"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[53],{86053:(gt,k,c)=>{c.r(k),c.d(k,{SystemModule:()=>ut});var v=c(39401),K=c(11292),u=c(25580),H=c(99114),j=c(69609),$=c(31531),e=c(22223),g=c(44755);let V=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.ez]}),o})();var X=c(80905),ee=c(61972),Q=c(22497),d=c(58016),P=c(56467),te=c(61135),z=c(51588),h=c(82004),S=c(17489),Z=c(12017),x=c(71683),p=c(30430),T=c(18505),w=c(3144);let L=(()=>{class o{constructor(t,n){this.httpClient=t,this._fuseConfirmationService=n}get(t={}){return this.httpClient.get("api/item-defines",{params:t})}edit(t,n){return this.httpClient.put(`api/item-defines/${encodeURIComponent(t)}`,n).pipe((0,T.b)(({success:i})=>{i&&(0,h.Hh)(this._fuseConfirmationService)}))}create(t){return this.httpClient.post("api/item-defines",t).pipe((0,T.b)(({success:n})=>{n&&(0,h.Hh)(this._fuseConfirmationService)}))}delete(t){return this.httpClient.delete(`api/item-defines/${encodeURIComponent(t)}`).pipe((0,T.b)(({success:n})=>{n&&(0,h.Hh)(this._fuseConfirmationService)}))}getItemDefineFormItem(){return this.httpClient.get("api/item-defines/form-items")}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(w.eN),e.LFG(x.R))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var y=c(430),f=c(51728);function ne(o,a){1&o&&(e.ynx(0),e._UZ(1,"th",16)(2,"th",17),e.BQk())}function ie(o,a){1&o&&(e.ynx(0),e._UZ(1,"th",16)(2,"th",17)(3,"th",18),e.BQk())}function oe(o,a){1&o&&(e.ynx(0),e._UZ(1,"th",19)(2,"th",20)(3,"th",21),e.BQk())}function se(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName)}}function le(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName),e.xp6(2),e.Oqu(t.itemTypeCode)}}function ae(o,a){if(1&o&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName),e.xp6(2),e.Oqu(t.gridId)}}function re(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td",9),e.NdJ("nzCheckedChange",function(i){const l=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.onItemChecked(l.itemId,i))}),e.qZA(),e.YNc(2,se,5,2,"ng-container",10),e.YNc(3,le,7,3,"ng-container",10),e.YNc(4,ae,7,3,"ng-container",10),e.qZA()}if(2&o){const t=a.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.setOfCheckedId.has(t.itemId)),e.xp6(1),e.Q6J("ngIf","button"===n.typeTable),e.xp6(1),e.Q6J("ngIf","formItem"===n.typeTable),e.xp6(1),e.Q6J("ngIf","column"===n.typeTable)}}let ce=(()=>{class o extends Z.Y{constructor(t,n,i,s,l,r){switch(super(s,i,t),this.dialogRef=t,this._dialog=n,this._itemDefineService=l,this.data=[],this.isCheckAll=!1,this.callBackSave=()=>this.data=this.data.filter(m=>this.setOfCheckedId.has(m.itemId)),this.data=r.data,this.setOfCheckedId=new Set(r.data.map(m=>m.itemId)),this.oldData=(0,S.cloneDeep)(r.data),this.typeTable=r.typeTable,this.typeTable){case"button":this._itemDefineService.get({itemTypeCode:"BTN"}).subscribe(m=>this.data=m.data);break;case"column":this._itemDefineService.get({itemTypeCode:"COL"}).subscribe(m=>this.data=m.data);break;case"formItem":this._itemDefineService.getItemDefineFormItem().subscribe(m=>this.data=m.data)}}updateCheckedSet(t,n){n?this.setOfCheckedId.add(t):this.setOfCheckedId.delete(t)}checkAll(t){this.data.forEach(({itemId:n})=>this.updateCheckedSet(n,t))}onItemChecked(t,n){this.updateCheckedSet(t,n)}save(){this.dialogRef.close(this.data.filter(t=>this.setOfCheckedId.has(t.itemId)))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.so),e.Y36(u.uw),e.Y36(x.R),e.Y36(p.Vn),e.Y36(L),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-menu-detail-popup"]],features:[e.qOj],decls:22,vars:10,consts:[[1,"flex","flex-col","flex-auto","md:w-auto","md:min-w-160","max-h-200","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium",3,"transloco"],["mat-icon-button","",3,"click"],[1,"icon-size-7","text-white",3,"svgIcon"],[1,"w-full","p-6","sm:p-8","space-y-1","overflow-y-auto","dark:bg-gray-900"],[1,"p-6","bg-card","shadow","rounded-md","overflow-hidden"],["nzBordered","","nzShowPagination","true",3,"nzData"],["basicTable",""],[3,"nzChecked","nzCheckedChange"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"flex","flex-row","justify-end","mt-5","space-x-2"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","save"],["transloco","id"],["transloco","name"],["transloco","type"],["transloco","system.colId"],["transloco","system.colName"],["transloco","system.gridId"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return n.closePopup()}),e._UZ(4,"mat-icon",4),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6)(7,"nz-table",7,8)(9,"thead")(10,"tr")(11,"th",9),e.NdJ("nzCheckedChange",function(s){return n.checkAll(s)}),e.qZA(),e.YNc(12,ne,3,0,"ng-container",10),e.YNc(13,ie,4,0,"ng-container",10),e.YNc(14,oe,4,0,"ng-container",10),e.qZA()(),e.TgZ(15,"tbody"),e.YNc(16,re,5,4,"tr",11),e.qZA()()(),e._UZ(17,"br"),e.TgZ(18,"div",12)(19,"button",13),e.NdJ("click",function(){return n.save()}),e._UZ(20,"mat-icon",14)(21,"label",15),e.qZA()()()()),2&t){const i=e.MAs(8);e.xp6(2),e.Q6J("transloco",n.typeTable),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("nzData",n.data),e.xp6(4),e.Q6J("nzChecked",n.isCheckAll),e.xp6(1),e.Q6J("ngIf","button"===n.typeTable),e.xp6(1),e.Q6J("ngIf","formItem"===n.typeTable),e.xp6(1),e.Q6J("ngIf","column"===n.typeTable),e.xp6(2),e.Q6J("ngForOf",i.data),e.xp6(3),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","save")}},dependencies:[g.sg,g.O5,p.KI,d.N8,d.Uo,d._C,d.h7,d.Om,d.p0,d.$Z,d.g6,y.Hw,f.lW,f.RK],encapsulation:2}),o})();var de=c(86913);let F=(()=>{class o{constructor(t,n){this.httpClient=t,this._fuseConfirmationService=n}getMenuTree(){return this.httpClient.get("api/menu-pages/tree")}getMenuDetailUi(t){return this.httpClient.get(`api/menu-pages/${encodeURIComponent(t)}/detail-ui`)}getMenuByRole(){return this.httpClient.get("api/menu-pages/menu-by-role")}editListMenuDetail(t,n){return this.httpClient.put(`api/menu-pages/${encodeURIComponent(t)}/batch`,n).pipe((0,T.b)(({success:i})=>{i&&(0,h.Hh)(this._fuseConfirmationService)}))}editMenuTree(t){return this.httpClient.post("api/menu-pages/update-menu-tree",t).pipe((0,T.b)(({success:n})=>{n&&(0,h.Hh)(this._fuseConfirmationService)}))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(w.eN),e.LFG(x.R))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var I=c(13617),G=c(44867),N=c(90504);const me=["nzTreeComponent"];function pe(o,a){if(1&o&&e.GkF(0,23),2&o){e.oxw();const t=e.MAs(29);e.Q6J("ngTemplateOutlet",t)}}function ue(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",24)(1,"div",9),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.TgZ(4,"div",25)(5,"div",26)(6,"div",27)(7,"span",28),e._uU(8,"Type Menu"),e.qZA(),e.TgZ(9,"mat-radio-group",29),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.changeTypeNode(i))}),e.TgZ(10,"mat-radio-button",30),e._uU(11,"Folder"),e.qZA(),e.TgZ(12,"mat-radio-button",31),e._uU(13,"Page"),e.qZA()()(),e._UZ(14,"cm-input",32),e.TgZ(15,"cm-input",33),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedNode.origin.name=i)}),e.qZA(),e.TgZ(16,"cm-input",34),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedNode.origin.url=i)}),e.qZA(),e.TgZ(17,"cm-input",35),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedNode.origin.iconName=i)}),e.qZA(),e.TgZ(18,"cm-input",36),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedNode.origin.desc=i)}),e.qZA()()(),e.TgZ(19,"div",25)(20,"div",37)(21,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.disableNode())}),e._UZ(22,"mat-icon",15)(23,"label",38),e.qZA(),e.TgZ(24,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveNode())}),e._UZ(25,"mat-icon",15)(26,"label",39),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,18,"system.detailInformation")," "),e.xp6(7),e.Q6J("ngModel",t.selectedNode.origin.type),e.xp6(5),e.Q6J("isDisableLength",!0)("actionEnum","view")("model",t.selectedNode.origin.parent),e.xp6(1),e.Q6J("isDisableLength",!0)("model",t.selectedNode.origin.name),e.xp6(1),e.Q6J("isDisableLength",!0)("actionEnum","page"===t.selectedNode.origin.type?"edit":"view")("model",t.selectedNode.origin.url),e.xp6(1),e.Q6J("isDisableLength",!0)("model",t.selectedNode.origin.iconName),e.xp6(1),e.Q6J("isDisableLength",!0)("model",t.selectedNode.origin.desc),e.xp6(3),e.Q6J("color","accent"),e.xp6(1),e.Q6J("svgIcon","do_not_disturb_on"),e.xp6(2),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","save")}}function ge(o,a){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA()()),2&o){const t=a.$implicit,n=a.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName)}}function _e(o,a){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&o){const t=a.$implicit,n=a.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName),e.xp6(2),e.Oqu(t.itemTypeCode)}}function he(o,a){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&o){const t=a.$implicit,n=a.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName),e.xp6(2),e.Oqu(t.gridId)}}const fe=function(){return{type:"button"}},xe=function(){return{type:"formItem"}},be=function(){return{type:"column"}};function ye(o,a){if(1&o&&(e.TgZ(0,"div",24)(1,"div",9),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.TgZ(4,"div",40)(5,"mat-tab-group",41)(6,"mat-tab",42),e.ALo(7,"transloco"),e.TgZ(8,"div",43)(9,"div",44)(10,"nz-table",45,46)(12,"thead")(13,"tr"),e._UZ(14,"th",47)(15,"th",48)(16,"th",49),e.qZA()(),e.TgZ(17,"tbody"),e.YNc(18,ge,7,3,"tr",50),e.qZA()()(),e.TgZ(19,"div",51),e.GkF(20,52),e.qZA()()(),e.TgZ(21,"mat-tab",42),e.ALo(22,"transloco"),e.TgZ(23,"div",43)(24,"div",44)(25,"nz-table",45,53)(27,"thead")(28,"tr"),e._UZ(29,"th",47)(30,"th",48)(31,"th",49)(32,"th",54),e.qZA()(),e.TgZ(33,"tbody"),e.YNc(34,_e,9,4,"tr",50),e.qZA()()(),e.TgZ(35,"div",51),e.GkF(36,52),e.qZA()()(),e.TgZ(37,"mat-tab",42),e.ALo(38,"transloco"),e.TgZ(39,"div",43)(40,"div",44)(41,"nz-table",45,55)(43,"thead")(44,"tr"),e._UZ(45,"th",47)(46,"th",56)(47,"th",57)(48,"th",58),e.qZA()(),e.TgZ(49,"tbody"),e.YNc(50,he,9,4,"tr",50),e.qZA()()(),e.TgZ(51,"div",51),e.GkF(52,52),e.qZA()()()()()()),2&o){const t=e.MAs(11),n=e.MAs(26),i=e.MAs(42),s=e.oxw(),l=e.MAs(31);e.xp6(2),e.hij(" ",e.lcZ(3,19,"system.detail")," "),e.xp6(4),e.Q6J("label",e.lcZ(7,21,"button")),e.xp6(4),e.Q6J("nzData",s.listButton)("nzLoading",s.loading),e.xp6(8),e.Q6J("ngForOf",t.data),e.xp6(2),e.Q6J("ngTemplateOutlet",l)("ngTemplateOutletContext",e.DdM(27,fe)),e.xp6(1),e.Q6J("label",e.lcZ(22,23,"formItem")),e.xp6(4),e.Q6J("nzData",s.listFormItem)("nzLoading",s.loading),e.xp6(9),e.Q6J("ngForOf",n.data),e.xp6(2),e.Q6J("ngTemplateOutlet",l)("ngTemplateOutletContext",e.DdM(28,xe)),e.xp6(1),e.Q6J("label",e.lcZ(38,25,"grid")),e.xp6(4),e.Q6J("nzData",s.listGrid)("nzLoading",s.loading),e.xp6(9),e.Q6J("ngForOf",i.data),e.xp6(2),e.Q6J("ngTemplateOutlet",l)("ngTemplateOutletContext",e.DdM(29,be))}}const E=function(o,a){return{"text-red-500":o,"text-primary-500":a}},Y=function(o){return{"text-red-500":o}};function Ce(o,a){if(1&o&&(e.TgZ(0,"span")(1,"span",65),e._UZ(2,"mat-icon",66),e.TgZ(3,"span",67),e._uU(4),e.ALo(5,"transloco"),e.qZA()()()),2&o){const t=e.oxw(),n=t.origin,i=t.$implicit;let s;e.xp6(2),e.Q6J("ngClass",e.WLB(6,E,n.pageDisabled,!n.pageDisabled))("svgIcon",n.pageDisabled?"do_not_disturb_on":i.isExpanded?null!==(s=n.iconName)&&void 0!==s?s:"folder_open":i.isExpanded?null!==(s=n.iconName)&&void 0!==s?s:"folder":null!==(s=n.iconName)&&void 0!==s?s:"folder_open"),e.xp6(1),e.Q6J("ngClass",e.VKq(9,Y,n.pageDisabled)),e.xp6(1),e.Oqu(e.lcZ(5,4,i.origin.name))}}function ve(o,a){if(1&o&&(e.TgZ(0,"span")(1,"span",65),e._UZ(2,"mat-icon",66),e.TgZ(3,"span",67),e._uU(4),e.ALo(5,"transloco"),e.qZA()()()),2&o){const t=e.oxw(),n=t.origin,i=t.$implicit;let s;e.xp6(2),e.Q6J("ngClass",e.WLB(6,E,n.pageDisabled,!n.pageDisabled))("svgIcon",n.pageDisabled?"do_not_disturb_on":i.isExpanded?null!==(s=n.iconName)&&void 0!==s?s:"folder_open":i.isExpanded?null!==(s=n.iconName)&&void 0!==s?s:"folder":null!==(s=n.iconName)&&void 0!==s?s:"insert_drive_file"),e.xp6(1),e.Q6J("ngClass",e.VKq(9,Y,n.pageDisabled)),e.xp6(1),e.Oqu(e.lcZ(5,4,i.origin.name))}}function Te(o,a){if(1&o&&(e.TgZ(0,"span",63),e.YNc(1,Ce,6,11,"span",64),e.YNc(2,ve,6,11,"span",64),e.qZA()),2&o){const t=a.origin;e.xp6(1),e.Q6J("ngIf","folder"===t.type),e.xp6(1),e.Q6J("ngIf","page"===t.type)}}function Ze(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",59)(1,"nz-tree",60,61),e.NdJ("nzClick",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectingNode(i))})("nzOnDrop",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.nzEvent(i))}),e.qZA(),e.YNc(3,Te,3,2,"ng-template",null,62,e.W1O),e.qZA()}if(2&o){const t=e.MAs(4),n=e.oxw();e.xp6(1),e.Q6J("nzData",n.treeData)("nzTreeTemplate",t)}}function Se(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",68)(1,"button",14),e.NdJ("click",function(){const s=e.CHM(t).type,l=e.oxw();return e.KtG(l.editRecordTable(s))}),e._UZ(2,"mat-icon",15)(3,"label",69),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","edit"))}let Ie=(()=>{class o{constructor(t,n,i){this._systemMenuDetailService=t,this._dialog=n,this._fuseConfirmationService=i,this.searchValue$=new te.X(""),this.searchValue=null,this.expandedNodes=[],this.nodes=[],this.treeData=[],this.listButton=[],this.listFormItem=[],this.listGrid=[],this._systemMenuDetailService.getMenuTree().subscribe(({data:s})=>{this.treeData=this.arrToTree(s)})}ngOnInit(){}getAncestors(t,n){if(typeof t<"u")for(let i=0;i<t.length;i++){if(t[i].key===n)return[t[i]];let s=this.getAncestors(t[i].children,n);if(null!==s)return s.unshift(t[i]),s}return null}selectingNode(t){this.selectedNode=t.node,this._systemMenuDetailService.getMenuDetailUi(this.selectedNode.origin.id).subscribe(n=>{this.listButton=n.data.filter(i=>"BTN"===i.itemTypeCode),this.listFormItem=n.data.filter(i=>"BTN"!==i.itemTypeCode&&"COL"!==i.itemTypeCode),this.listGrid=n.data.filter(i=>"COL"===i.itemTypeCode)})}addNode(){const t=this.selectedNode;let n=(0,z.Z)();if(t){t.children=t.children||[];let i=new de.Zr({title:"",key:n,id:n,parent:this.selectedNode.origin.name,type:"folder"},t);t.addChildren([i])}}changeTypeNode(t){const n=t;"folder"===n?(this.selectedNode.isLeaf=!1,this.selectedNode.origin.type="folder"):"page"===n&&(this.selectedNode.isLeaf=!0,this.selectedNode.origin.type="page"),this.saveNode()}removeNode(){(0,h.WD)(this._fuseConfirmationService,"message.delete").afterClosed().subscribe(t=>{"confirmed"===t&&(this.selectedNode.remove(),this._systemMenuDetailService.editMenuTree(this.convertTreeToArr()).subscribe())})}disableNode(){(0,h.WD)(this._fuseConfirmationService,"message.disable").afterClosed().subscribe(t=>{if("confirmed"===t){let n=this.selectedNode,i=!n.origin.pageDisabled;this.getAncestors(this.nzTreeComponent.getTreeNodes(),this.selectedNode.key).forEach((r,m)=>{i||(r.origin.pageDisabled=!1)});const l=(r,m)=>{r.origin.pageDisabled=m,r.children&&r.children.forEach(_=>{l(_,m)})};l(n,i),this._systemMenuDetailService.editMenuTree(this.convertTreeToArr()).subscribe()}})}saveNode(){this.selectedNode&&(this.selectedNode.origin.name!=this.selectedNode.origin.name&&(i=>{this.selectedNode.getChildren().forEach(s=>{s.origin.parent=this.selectedNode.origin.name})})(),this.selectedNode.origin.type=this.selectedNode.origin.type,this.selectedNode.origin.name=this.selectedNode.origin.name,this.selectedNode.origin.url=this.selectedNode.origin.url,this.selectedNode.origin.pageDisabled=this.selectedNode.origin.pageDisabled,this.selectedNode.origin.desc=this.selectedNode.origin.desc,this.selectedNode.origin.orderNum=this.selectedNode.origin.orderNum,this.selectedNode.origin.key=this.selectedNode.origin.key,this.selectedNode.origin.iconName=this.selectedNode.origin.iconName);let t=this.convertTreeToArr();this._systemMenuDetailService.editMenuTree(t).subscribe(({})=>{})}convertTreeToArr(){let t=[];const n=(i,s)=>{i.forEach((l,r)=>{l.children&&l.children.length>0?(s.push({parentMenuId:l.origin.parent,menuPageName:l.origin.name,menuPageOrderByNumber:r,menuPageDescription:l.origin.desc,menuPageUrl:l.origin.url,isMenu:"folder"===l.origin.type,isUse:!l.origin.pageDisabled,isDelete:!1,menuPageId:l.origin.id,iconName:l.origin.iconName}),n(l.children,s)):s.push({parentMenuId:l.origin.parent,menuPageName:l.origin.name,menuPageDescription:l.origin.desc,menuPageUrl:l.origin.url,menuPageOrderByNumber:r,isMenu:"folder"===l.origin.type,isUse:!l.origin.pageDisabled,isDelete:!1,menuPageId:l.origin.id,iconName:l.origin.iconName})})};return n(this.nzTreeComponent.getTreeNodes(),t),t}ngOnDestroy(){}arrToTree(t){let s,r,n=t.map(m=>({...m,children:[]})),i={},l=[];for(r=0;r<n.length;r+=1)i[n[r].menuPageName]=r,n[r].children=[];for(r=0;r<n.length;r+=1)s={title:n[r].menuPageName,key:n[r].menuPageName,orderNum:n[r].menuPageOrderByNumber,id:n[r].menuPageId,expanded:!0,pageDisabled:!n[r].isUse,iconName:n[r].iconName,isLeaf:!n[r].isMenu,children:n[r].children,type:n[r].isMenu?"folder":"page",desc:n[r].menuPageDescription,name:n[r].menuPageName,parent:n[r].parentMenuId,url:n[r].menuPageUrl},"_"!==s.parent?n[i[s.parent]].children.push(s):l.push(s);return l}nzEvent(t){t.dragNode.origin.parent=t.dragNode.parentNode.origin.name,this.saveNode()}editRecordTable(t){this._dialog.open(ce,{disableClose:!0,data:{typeTable:t,data:"button"===t?this.listButton:"column"===t?this.listGrid:"formItem"===t?this.listFormItem:[]}}).afterClosed().subscribe(i=>{switch(t){case"button":this.listButton=[...i];break;case"column":this.listGrid=[...i];break;case"formItem":this.listFormItem=[...i]}this._systemMenuDetailService.editListMenuDetail(this.selectedNode.origin.id,[...this.listGrid,...this.listButton,...this.listFormItem]).subscribe()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(F),e.Y36(u.uw),e.Y36(x.R))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-menu-detail"]],viewQuery:function(t,n){if(1&t&&e.Gf(me,5),2&t){let i;e.iGM(i=e.CRH())&&(n.nzTreeComponent=i.first)}},decls:32,vars:16,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","sm:justify-between","mb-6","px-6","sm:py-4","md:px-8","border-b","bg-card","dark:bg-transparent"],[1,"text-3xl","font-bold","tracking-tight","leading-none"],[1,"flex","flex-col","gap-4","sm:flex-row","bg-card","py-4","px-4","overflow-hidden","shadow","rounded-md","mx-6"],[1,"flex-2",3,"isDisableLength","placeholder","modelChange"],[1,"flex-2"],[1,"py-4","mx-6"],[1,"grid","grid-cols-1","sm:grid-cols-12","sm:space-x-4","space-y-4","sm:space-y-0"],[1,"col-span-1","sm:col-span-4","bg-card","shadow","rounded-md","overflow-hidden"],[1,"py-3","pl-4","bg-gray-200","font-semibold","text-xl"],[1,"py-5","pl-4","min-h-60","max-h-screen-60","overflow-y-scroll"],[3,"ngTemplateOutlet",4,"ngIf"],[1,"py-5","pl-4"],[1,"flex","sm:flex-row","space-x-2.5","justify-end","px-3"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","add"],["transloco","delete"],[1,"col-span-1","sm:col-span-3"],["class","bg-card shadow rounded-md overflow-hidden min-h-160",4,"ngIf"],[1,"col-span-1","sm:col-span-5"],["tree",""],["listTableButton",""],[3,"ngTemplateOutlet"],[1,"bg-card","shadow","rounded-md","overflow-hidden","min-h-160"],[1,"py-5","px-9"],[1,"flex","flex-col","w-full","space-y-3"],[1,"flex","flex-col","gt-sm:ml-16","mb-3"],[1,"font-medium","mb-3"],["color","primary",1,"space-x-4",3,"ngModel","ngModelChange"],["value","folder"],["value","page"],["label","Parent Menu",3,"isDisableLength","actionEnum","model"],["label","Menu Name",3,"isDisableLength","model","modelChange"],["label","URL",3,"isDisableLength","actionEnum","model","modelChange"],["label","Icon",3,"isDisableLength","model","modelChange"],["label","Description",3,"isDisableLength","model","modelChange"],[1,"flex","sm:flex-row","space-x-2.5","justify-end"],["transloco","disable"],["transloco","save"],[1,"py-5","pl-4","min-h-160"],["color","primary"],[3,"label"],[1,"flex","flex-col"],[1,"flex-grow"],["nzBordered","",3,"nzData","nzLoading"],["buttonTable",""],["nzWidth","60px","transloco","no"],["transloco","id"],["transloco","name"],[4,"ngFor","ngForOf"],[1,"flex-grow-0"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["formTable",""],["transloco","type"],["gridTable",""],["transloco","system.colId"],["transloco","system.colName"],["transloco","system.gridId"],[1,"flex","flex-col","justify-between"],["nzBlockNode","","nzDraggable","",3,"nzData","nzTreeTemplate","nzClick","nzOnDrop"],["nzTreeComponent",""],["nzTreeTemplate",""],[1,"custom-node"],[4,"ngIf"],[1,"flex"],["aria-hidden","false","aria-label","",3,"ngClass","svgIcon"],[1,"ml-1",3,"ngClass"],[1,"flex","sm:flex-row","space-x-2.5","justify-end","mt-3"],["transloco","edit"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"transloco"),e.qZA()(),e.TgZ(5,"div",3)(6,"cm-input",4),e.NdJ("modelChange",function(s){return n.searchValue$.next(s)}),e.qZA(),e._UZ(7,"div",5),e.qZA(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9),e._uU(12),e.ALo(13,"transloco"),e.qZA(),e.TgZ(14,"div",10),e.YNc(15,pe,1,1,"ng-container",11),e.qZA(),e.TgZ(16,"div",12)(17,"div",13)(18,"button",14),e.NdJ("click",function(){return n.addNode()}),e._UZ(19,"mat-icon",15)(20,"label",16),e.qZA(),e.TgZ(21,"button",14),e.NdJ("click",function(){return n.removeNode()}),e._UZ(22,"mat-icon",15)(23,"label",17),e.qZA()()()(),e.TgZ(24,"div",18),e.YNc(25,ue,27,20,"div",19),e.qZA(),e.TgZ(26,"div",20),e.YNc(27,ye,53,30,"div",19),e.qZA()()()(),e.YNc(28,Ze,5,2,"ng-template",null,21,e.W1O),e.YNc(30,Se,4,2,"ng-template",null,22,e.W1O)),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,12,"nav.menuDetail")," "),e.xp6(3),e.Q6J("isDisableLength",!0)("placeholder","placeholder.enterNameOrId")("isDisableLength",!0),e.xp6(6),e.hij(" ",e.lcZ(13,14,"system.menu")," "),e.xp6(3),e.Q6J("ngIf",!0),e.xp6(3),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","add"),e.xp6(2),e.Q6J("color","warn"),e.xp6(1),e.Q6J("svgIcon","delete"),e.xp6(3),e.Q6J("ngIf",n.selectedNode),e.xp6(2),e.Q6J("ngIf","page"===(null==n.selectedNode?null:n.selectedNode.origin.type)))},dependencies:[g.mk,g.sg,g.O5,g.tP,v.JJ,v.On,p.KI,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,y.Hw,f.lW,I.uX,I.SP,G.VQ,G.U0,N.W,P.Hc,p.Ot],encapsulation:2}),o})();var A=c(47148);const M=function(o){return{"bg-gray-100":o}};function Ne(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return l.selectedRecord=s,e.KtG(l.isNewItem=!1)}),e.TgZ(1,"td",34),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA()()}if(2&o){const t=a.$implicit,n=a.index,i=e.oxw();e.Q6J("ngClass",e.VKq(4,M,t.itemId===(null==i.selectedRecord?null:i.selectedRecord.itemId))),e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName)}}function Ae(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return l.selectedRecord=s,e.KtG(l.isNewItem=!1)}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()}if(2&o){const t=a.$implicit,n=a.index,i=e.oxw();e.Q6J("ngClass",e.VKq(5,M,t.itemId===(null==i.selectedRecord?null:i.selectedRecord.itemId))),e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName),e.xp6(2),e.Oqu(t.itemTypeCode)}}function De(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return l.selectedRecord=s,e.KtG(l.isNewItem=!1)}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()}if(2&o){const t=a.$implicit,n=a.index,i=e.oxw();e.Q6J("ngClass",e.VKq(5,M,t.itemId===(null==i.selectedRecord?null:i.selectedRecord.itemId))),e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.gridId),e.xp6(2),e.Oqu(t.itemId),e.xp6(2),e.Oqu(t.itemName)}}function we(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.add())}),e._UZ(1,"mat-icon",6)(2,"label",8),e.qZA()}2&o&&(e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","add"))}function Me(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.update())}),e._UZ(1,"mat-icon",6)(2,"label",46),e.qZA()}2&o&&(e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","save"))}function Je(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",35)(1,"div",36),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.TgZ(4,"div",1)(5,"div",37)(6,"div",38)(7,"cm-input",39),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedRecord.itemId=i)}),e.qZA()(),e.TgZ(8,"div",38)(9,"cm-input",40),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedRecord.itemName=i)}),e.qZA()(),e.TgZ(10,"div",38)(11,"cm-select",41),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedRecord.itemTypeCode=i)}),e.qZA()(),e.TgZ(12,"div",38)(13,"cm-input",42),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedRecord.gridId=i)}),e.qZA()()(),e.TgZ(14,"div",43),e.YNc(15,we,3,2,"button",44),e.YNc(16,Me,3,2,"button",44),e.TgZ(17,"button",5),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.delete())}),e._UZ(18,"mat-icon",6)(19,"label",45),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,20,"nav.generalItemsDefine")," "),e.xp6(5),e.Q6J("isDisableLength",!0)("actionEnum",t.isNewItem?"edit":"view")("label","id")("model",t.selectedRecord.itemId),e.xp6(2),e.Q6J("isDisableLength",!0)("label","name")("model",t.selectedRecord.itemName),e.xp6(2),e.Q6J("listData",t.listItemType)("label","system.itemType")("model",t.selectedRecord.itemTypeCode)("actionEnum",1===t.tabIndex?"edit":"view"),e.xp6(2),e.Q6J("isDisableLength",!0)("actionEnum",2===t.tabIndex?"edit":"view")("label","system.gridId")("model",t.selectedRecord.gridId),e.xp6(2),e.Q6J("ngIf",t.isNewItem),e.xp6(1),e.Q6J("ngIf",!t.isNewItem),e.xp6(1),e.Q6J("color","warn"),e.xp6(1),e.Q6J("svgIcon","delete")}}let qe=(()=>{class o{constructor(t,n,i){this._systemGeneralItemsDefineService=t,this._translocoService=n,this._fuseConfirmationService=i,this.loading=!1,this.listButton=[],this.listFormItem=[],this.listGrid=[],this.listItemType=[],this.isNewItem=!1,this.tabIndex=0,this.filter={id:"",name:"",itemTypeCode:"-1"}}onClickSearch(){this.getInitData()}ngOnInit(){this.getInitData()}getInitData(){this.loading=!0,this._systemGeneralItemsDefineService.get(this.filter).subscribe(t=>{this.listButton=t.data.filter(n=>"BTN"===n.itemTypeCode),this.listFormItem=t.data.filter(n=>"BTN"!==n.itemTypeCode&&"COL"!==n.itemTypeCode),this.listGrid=t.data.filter(n=>"COL"===n.itemTypeCode),this.loading=!1})}addNewRecord(){switch(this.selectedRecord=null,this.isNewItem=!0,this.newRecord={itemId:null,itemName:null,itemTypeCode:null,itemLabelId:null,gridId:null},this.tabIndex){case 0:this.newRecord.itemTypeCode="BTN",this.listButton=[...this.listButton,this.newRecord],this.selectedRecord=this.listButton[this.listButton.length-1];break;case 1:this.listFormItem=[...this.listFormItem,this.newRecord],this.selectedRecord=this.listFormItem[this.listFormItem.length-1];break;case 2:this.newRecord.itemTypeCode="COL",this.listGrid=[...this.listGrid,this.newRecord],this.selectedRecord=this.listGrid[this.listGrid.length-1]}}add(){this._systemGeneralItemsDefineService.create(this.selectedRecord).subscribe(t=>this.isNewItem=!1)}update(){this._systemGeneralItemsDefineService.edit(this.selectedRecord.itemId,this.selectedRecord).subscribe()}delete(){(0,h.WD)(this._fuseConfirmationService,"message.delete").afterClosed().subscribe(t=>{"confirmed"===t&&this._systemGeneralItemsDefineService.delete(this.selectedRecord.itemId).subscribe(n=>{this.selectedRecord=null,this.getInitData()})})}ngOnDestroy(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(L),e.Y36(p.Vn),e.Y36(x.R))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-general-items-define"]],decls:60,vars:35,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col"],[1,"flex","flex-col","sm:flex-row","bg-card","border-b","dark:bg-transparent","mb-6","px-6","items-start","sm:items-center","sm:py-4","md:px-8","sm:justify-between"],[1,"leading-none","text-3xl","font-bold","tracking-tight"],[1,"space-x-4","mt-4","sm:mt-0"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","search"],["transloco","add"],[1,"flex","flex-col","gap-4","sm:flex-row","bg-card","py-4","px-4","overflow-hidden","shadow","rounded-md","mx-6"],[1,"flex-2",3,"model","placeholder","isDisableLength","modelChange"],[1,"flex-3",3,"model","placeholder","isDisableLength","modelChange"],[1,"flex-1",3,"model","listData","modelChange"],[1,"flex-2"],[1,"flex","flex-col","gap-6","sm:flex-row","py-6","mx-6"],[1,"flex-1","p-6","bg-card","rounded-md","shadow","overflow-hidden"],[3,"selectedIndex","selectedIndexChange"],[3,"label"],[1,""],["nzBordered","",3,"nzData","nzLoading"],["buttonTable",""],["nzAlign","center","nzWidth","66px","transloco","no"],["transloco","id"],["transloco","name"],["class","cursor-pointer",3,"ngClass","click",4,"ngFor","ngForOf"],["formTable",""],["transloco","no"],["transloco","type"],["gridTable",""],["transloco","system.gridId"],["transloco","system.colId"],["transloco","system.colName"],["class","flex-1 bg-card shadow rounded-md overflow-hidden",4,"ngIf"],[1,"cursor-pointer",3,"ngClass","click"],["nzAlign","center"],[1,"flex-1","bg-card","shadow","rounded-md","overflow-hidden"],[1,"py-3","pl-4","bg-gray-200","font-semibold","text-xl"],[1,"p-6","flex-grow"],[1,"flex-1"],["isRequired","true",3,"isDisableLength","actionEnum","label","model","modelChange"],["isRequired","true",3,"isDisableLength","label","model","modelChange"],["isRequired","true",3,"listData","label","model","actionEnum","modelChange"],[3,"isDisableLength","actionEnum","label","model","modelChange"],[1,"flex","justify-end","space-x-4","pt-6","px-6","w-full","mt-auto","flex-grow-0"],["mat-flat-button","","class","w-min",3,"color","click",4,"ngIf"],["transloco","delete"],["transloco","update"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return n.onClickSearch()}),e._UZ(8,"mat-icon",6)(9,"label",7),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return n.addNewRecord()}),e._UZ(11,"mat-icon",6)(12,"label",8),e.qZA()()(),e.TgZ(13,"div",9)(14,"cm-input",10),e.NdJ("modelChange",function(s){return n.filter.id=s}),e.qZA(),e.TgZ(15,"cm-input",11),e.NdJ("modelChange",function(s){return n.filter.name=s}),e.qZA(),e.TgZ(16,"cm-select",12),e.NdJ("modelChange",function(s){return n.filter.itemTypeCode=s}),e.qZA(),e._UZ(17,"div",13),e.qZA(),e.TgZ(18,"div",14)(19,"div",15)(20,"mat-tab-group",16),e.NdJ("selectedIndexChange",function(s){return n.tabIndex=s}),e.TgZ(21,"mat-tab",17),e.ALo(22,"transloco"),e.TgZ(23,"div",18)(24,"nz-table",19,20)(26,"thead")(27,"tr"),e._UZ(28,"th",21)(29,"th",22)(30,"th",23),e.qZA()(),e.TgZ(31,"tbody"),e.YNc(32,Ne,7,6,"tr",24),e.qZA()()()(),e.TgZ(33,"mat-tab",17),e.ALo(34,"transloco"),e.TgZ(35,"div",18)(36,"nz-table",19,25)(38,"thead")(39,"tr"),e._UZ(40,"th",26)(41,"th",22)(42,"th",23)(43,"th",27),e.qZA()(),e.TgZ(44,"tbody"),e.YNc(45,Ae,9,7,"tr",24),e.qZA()()()(),e.TgZ(46,"mat-tab",17),e.ALo(47,"transloco"),e.TgZ(48,"div",18)(49,"nz-table",19,28)(51,"thead")(52,"tr"),e._UZ(53,"th",26)(54,"th",29)(55,"th",30)(56,"th",31),e.qZA()(),e.TgZ(57,"tbody"),e.YNc(58,De,9,7,"tr",24),e.qZA()()()()()(),e.YNc(59,Je,20,22,"div",32),e.qZA()()()),2&t){const i=e.MAs(25),s=e.MAs(37),l=e.MAs(50);e.xp6(4),e.hij(" ",e.lcZ(5,27,"nav.generalItemsDefine")," "),e.xp6(3),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","search"),e.xp6(2),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","add"),e.xp6(3),e.Q6J("model",n.filter.id)("placeholder","placeholder.enterId")("isDisableLength",!0),e.xp6(1),e.Q6J("model",n.filter.name)("placeholder","placeholder.enterName")("isDisableLength",!0),e.xp6(1),e.Q6J("model",n.filter.itemTypeCode)("listData",n.listItemType),e.xp6(4),e.Q6J("selectedIndex",n.tabIndex),e.xp6(1),e.Q6J("label",e.lcZ(22,29,"button")),e.xp6(3),e.Q6J("nzData",n.listButton)("nzLoading",n.loading),e.xp6(8),e.Q6J("ngForOf",i.data),e.xp6(1),e.Q6J("label",e.lcZ(34,31,"formItem")),e.xp6(3),e.Q6J("nzData",n.listFormItem)("nzLoading",n.loading),e.xp6(9),e.Q6J("ngForOf",s.data),e.xp6(1),e.Q6J("label",e.lcZ(47,33,"grid")),e.xp6(3),e.Q6J("nzData",n.listGrid)("nzLoading",n.loading),e.xp6(9),e.Q6J("ngForOf",l.data),e.xp6(1),e.Q6J("ngIf",n.selectedRecord)}},dependencies:[g.mk,g.sg,g.O5,p.KI,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,d.UX,y.Hw,f.lW,I.uX,I.SP,A.f,N.W,p.Ot],encapsulation:2}),o})();var Oe=c(10418),Ue=c(20964),C=c(81267),D=c(77579),b=c(82722),Re=c(28746);let J=(()=>{class o{constructor(t,n){this._httpClient=t,this._fuseConfirmationService=n}getDetailUi(t,n){return this._httpClient.get(`api/button-authorities/${encodeURIComponent(t)}/${encodeURIComponent(n)}/ui-details`)}getMenuTree(t){return this._httpClient.get(`api/button-authorities/${encodeURIComponent(t)}/menu-tree-authority`)}updateTreeMenu(t,n){return this._httpClient.put(`api/button-authorities/${encodeURIComponent(t)}/update-menu-authority`,n).pipe((0,T.b)(({})=>{}))}updateUiDetail(t,n,i){return this._httpClient.put(`api/button-authorities/${encodeURIComponent(t)}/${encodeURIComponent(n)}/update-ui-detail`,i).pipe((0,T.b)(({success:s})=>{s&&(0,h.Hh)(this._fuseConfirmationService)}))}checkPermission(t){return this._httpClient.get(`api/button-authorities/${encodeURIComponent(t)}/have-permission`)}copyRole(t){return this._httpClient.post("api/button-authorities/copy-role",t).pipe((0,T.b)(({success:n})=>{n&&(0,h.Hh)(this._fuseConfirmationService)}))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(w.eN),e.LFG(x.R))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var q=c(1215);let ke=(()=>{class o extends Z.Y{constructor(t,n,i,s,l,r,m,_){super(m,r,t),this.dialogRef=t,this._dialog=n,this._systemUiButtonAuthorityService=i,this._roleService=s,this._transloco=l,this.fuseConfirmationService=r,this.listRole=[],this._unsubscribeAll=new D.x,this.isBtnLoading=!1,this.fromRole=_}ngOnInit(){this._roleService.get().pipe((0,b.R)(this._unsubscribeAll)).subscribe(({data:t})=>{this.listRole=t.filter(n=>n.roleId!==this.fromRole.id).map(n=>({id:n.roleId,name:n.roleName}))})}copy(){(0,h.WD)(this.fuseConfirmationService,...Array(1),this._transloco.translate("message.copy",{fromRole:this.fromRole.name,toRole:this.selectedRole.name})).afterClosed().subscribe(t=>{"confirmed"===t&&(this.isBtnLoading=!0,this._systemUiButtonAuthorityService.copyRole({fromRoleId:this.fromRole.id,toRoleId:this.selectedRole.id}).pipe((0,b.R)(this._unsubscribeAll),(0,Re.x)(()=>this.isBtnLoading=!1)).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.so),e.Y36(u.uw),e.Y36(J),e.Y36(q.N),e.Y36(p.Vn),e.Y36(x.R),e.Y36(p.Vn),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-role-management-copy-popup"]],features:[e.qOj],decls:16,vars:7,consts:[[1,"flex","flex-col","flex-auto","md:w-auto","md:min-w-160","max-h-200","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],["transloco","system.roleManagement",1,"text-lg","font-medium"],["mat-icon-button","",3,"click"],[1,"icon-size-7","text-white",3,"svgIcon"],[1,"w-full","p-6","sm:p-8","space-y-1","overflow-y-auto","dark:bg-gray-900","shadow"],[1,"p-6","bg-card","shadow","rounded-md","overflow-hidden"],["label","system.role",1,"flex-1","w-60",3,"combineModel","listData","combineModelChange"],[1,"flex","flex-row","justify-end","mt-5","space-x-2"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","copy",1,"pl-2"],["transloco","close",1,"pl-2"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return n.buttonClose()}),e._UZ(4,"mat-icon",4),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6)(7,"cm-select",7),e.NdJ("combineModelChange",function(s){return n.selectedRole=s}),e.qZA()(),e._UZ(8,"br"),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){return n.copy()}),e._UZ(11,"mat-icon",10)(12,"label",11),e.qZA(),e.TgZ(13,"button",9),e.NdJ("click",function(){return n.closePopup()}),e._UZ(14,"mat-icon",10)(15,"label",12),e.qZA()()()()),2&t&&(e.xp6(4),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("combineModel",n.selectedRole)("listData",n.listRole),e.xp6(3),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","content_copy"),e.xp6(2),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","close"))},dependencies:[p.KI,y.Hw,f.lW,f.RK,A.f],encapsulation:2}),o})();var Qe=c(58397);function Pe(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.startEdit(i.roleId))}),e._UZ(7,"mat-icon",15)(8,"label",22),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.roleName),e.xp6(2),e.Oqu(t.roleDescription),e.xp6(2),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","edit")}}function ze(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"td")(1,"input",23),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw();return e.KtG(l.editCache[s.roleId].data.roleName=i)}),e.qZA()(),e.TgZ(2,"td")(3,"input",23),e.NdJ("ngModelChange",function(i){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw();return e.KtG(l.editCache[s.roleId].data.roleDescription=i)}),e.qZA()(),e.TgZ(4,"td")(5,"div",24)(6,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.saveEdit(i.roleId))}),e._UZ(7,"label",17),e.qZA(),e.TgZ(8,"button",25),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.cancelEdit(i.roleId))}),e._UZ(9,"label",26),e.qZA()()()}if(2&o){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngModel",n.editCache[t.roleId].data.roleName),e.xp6(2),e.Q6J("ngModel",n.editCache[t.roleId].data.roleDescription),e.xp6(3),e.Q6J("color","primary"),e.xp6(2),e.Q6J("color","white")}}const Le=function(o){return{"bg-gray-100":o}};function Fe(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr",19),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.selectedRecord=s)}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.YNc(3,Pe,9,4,"ng-container",20),e.YNc(4,ze,10,4,"ng-template",null,21,e.W1O),e.qZA()}if(2&o){const t=a.$implicit,n=e.MAs(5),i=e.oxw();e.Q6J("ngClass",e.VKq(4,Le,t.roleId===(null==i.selectedRecord?null:i.selectedRecord.roleId))),e.xp6(2),e.Oqu(t.orderByNumber+1),e.xp6(1),e.Q6J("ngIf",!i.editCache[t.roleId].edit)("ngIfElse",n)}}function Ge(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.delete())}),e._UZ(1,"label",27),e.qZA()}2&o&&e.Q6J("color","warn")}let Ee=(()=>{class o extends Z.Y{constructor(t,n,i,s,l,r,m){super(r,l,t),this.dialogRef=t,this._systemUiButtonAuthorityService=n,this._roleService=i,this._dialog=s,this.listData=[],this.editCache={},this._roleService.get().subscribe(_=>{this.listData=_.data,this.updateEditCache()})}cancelEdit(t){const n=this.listData.findIndex(i=>i.roleId===t);this.editCache[t]={data:{...this.listData[n]},edit:!1}}updateEditCache(){this.listData.forEach(t=>{this.editCache[t.roleId]={edit:!1,data:{...t}}})}startEdit(t){this.editCache[t].edit=!0}saveEdit(t){const n=this.listData.findIndex(i=>i.roleId===t);Object.assign(this.listData[n],this.editCache[t].data),this.editCache[t].edit=!1}save(){this._roleService.editListRole(this.listData).subscribe(t=>this.closePopup())}add(){const t=(0,z.Z)();this.listData=[...this.listData,{roleId:t,roleDescription:null,roleName:null,orderByNumber:this.listData.length}],this.updateEditCache(),this.startEdit(t)}delete(){this._roleService.isRoleUsed(this.selectedRecord.roleId).subscribe(({data:t})=>{if(!t){let n=this.listData.findIndex(i=>i.roleId==this.selectedRecord.roleId);this.listData.splice(n,1),this.listData=[...this.listData],this.updateEditCache()}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.so),e.Y36(J),e.Y36(q.N),e.Y36(u.uw),e.Y36(x.R),e.Y36(p.Vn),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-role-management-popup"]],features:[e.qOj],decls:25,vars:7,consts:[[1,"flex","flex-col","flex-auto","md:w-auto","md:min-w-160","max-h-200","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],["transloco","system.roleManagement",1,"text-lg","font-medium"],["mat-icon-button","",3,"click"],[1,"icon-size-7","text-white",3,"svgIcon"],[1,"w-full","p-6","sm:p-8","space-y-1","overflow-y-auto","dark:bg-gray-900","shadow"],[1,"p-6","bg-card","shadow","rounded-md","overflow-hidden"],["nzBordered","","nzShowPagination","true",3,"nzData"],["basicTable",""],["transloco","no"],["transloco","system.roleName"],["transloco","system.desc"],["class","cursor-pointer",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"flex","flex-row","justify-end","mt-5","space-x-2"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","add",1,"pl-2"],["transloco","save"],["mat-flat-button","","class","w-min",3,"color","click",4,"ngIf"],[1,"cursor-pointer",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["editTemplate",""],["transloco","edit",1,"pl-2"],["type","text","nz-input","",3,"ngModel","ngModelChange"],[1,"flex","flex-row","space-x-4"],["mat-button","",1,"w-min",3,"color","click"],["transloco","system.cancel"],["transloco","delete"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return n.buttonClose()}),e._UZ(4,"mat-icon",4),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6)(7,"nz-table",7,8)(9,"thead")(10,"tr"),e._UZ(11,"th",9)(12,"th",10)(13,"th",11)(14,"th"),e.qZA()(),e.TgZ(15,"tbody"),e.YNc(16,Fe,6,6,"tr",12),e.qZA()()(),e._UZ(17,"br"),e.TgZ(18,"div",13)(19,"button",14),e.NdJ("click",function(){return n.add()}),e._UZ(20,"mat-icon",15)(21,"label",16),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return n.save()}),e._UZ(23,"label",17),e.qZA(),e.YNc(24,Ge,2,1,"button",18),e.qZA()()()),2&t){const i=e.MAs(8);e.xp6(4),e.Q6J("svgIcon","heroicons_outline:x-mark"),e.xp6(3),e.Q6J("nzData",n.listData),e.xp6(9),e.Q6J("ngForOf",i.data),e.xp6(3),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","add"),e.xp6(2),e.Q6J("color","primary"),e.xp6(2),e.Q6J("ngIf",n.selectedRecord)}},dependencies:[g.mk,g.sg,g.O5,v.Fj,v.JJ,v.On,Qe.Zp,p.KI,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,y.Hw,f.lW,f.RK],encapsulation:2}),o})();var Ye=c(2242),Be=c(23697),Ke=c(50877);function He(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveDetail())}),e._UZ(1,"label",17),e.qZA()}2&o&&e.Q6J("color","primary")}function je(o,a){if(1&o&&e.GkF(0,25),2&o){e.oxw(2);const t=e.MAs(21);e.Q6J("ngTemplateOutlet",t)}}function $e(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",26)(1,"div",20)(2,"div"),e._uU(3),e.ALo(4,"transloco"),e.qZA()(),e.TgZ(5,"div",27)(6,"mat-slide-toggle",28),e.NdJ("ngModelChange",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.disableNode())}),e._uU(7),e.ALo(8,"transloco"),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.hij(" ",e.lcZ(4,4,"system.detail"),""),e.xp6(3),e.Q6J("color","primary")("ngModel",!t.selectedNode.disabled),e.xp6(1),e.hij(" ",e.lcZ(8,6,"system.authority")," ")}}function We(o,a){if(1&o&&(e.TgZ(0,"div",18)(1,"div",19)(2,"div",20)(3,"div"),e._uU(4),e.ALo(5,"transloco"),e.qZA()(),e.TgZ(6,"div",21),e.YNc(7,je,1,1,"ng-container",22),e.qZA()(),e.TgZ(8,"div",23),e.YNc(9,$e,9,8,"div",24),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,3,"system.menu"),""),e.xp6(3),e.Q6J("ngIf",!0),e.xp6(2),e.Q6J("ngIf",t.selectedNode)}}function Ve(o,a){1&o&&(e.TgZ(0,"nz-tree-node-toggle"),e._UZ(1,"span",38),e.qZA())}const Xe=function(o,a){return{"text-red-500":o,"text-primary-500":a}},et=function(o){return{"text-red-500":o}};function tt(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"nz-tree-node",32),e.YNc(1,Ve,2,0,"nz-tree-node-toggle",33),e.TgZ(2,"nz-tree-node-option",34),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.selectingNode(s))})("nzClick",function(){const s=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.selectListSelection.toggle(s))}),e.TgZ(3,"span",35),e._UZ(4,"mat-icon",36),e.TgZ(5,"span",37),e._uU(6),e.ALo(7,"transloco"),e.qZA()()()()}if(2&o){const t=a.$implicit,n=e.oxw(2);let i;e.xp6(1),e.Q6J("ngIf",t.expandable),e.xp6(1),e.Q6J("nzSelected",n.selectListSelection.isSelected(t)),e.xp6(2),e.Q6J("ngClass",e.WLB(8,Xe,t.disabled,!t.disabled))("svgIcon",t.disabled?"do_not_disturb_on":n.treeControl.isExpanded(t)&&t.expandable?null!==(i=t.iconName)&&void 0!==i?i:"folder_open":t.expandable?null!==(i=t.iconName)&&void 0!==i?i:"folder":null!==(i=t.iconName)&&void 0!==i?i:"insert_drive_file"),e.xp6(1),e.Q6J("ngClass",e.VKq(11,et,t.disabled)),e.xp6(1),e.Oqu(e.lcZ(7,6,t.name))}}function nt(o,a){if(1&o&&(e.TgZ(0,"div",29)(1,"nz-tree-view",30),e.YNc(2,tt,8,13,"nz-tree-node",31),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("nzTreeControl",t.treeControl)("nzDataSource",t.dataSource)}}let it=(()=>{class o{constructor(t,n,i,s){this._systemRolePageAuthorityService=t,this._menuPageService=n,this._roleService=i,this._dialog=s,this.transformer=(l,r)=>{const m=this.nestedNodeMap.get(l),_=m&&m.key===l.key?m:{expandable:"folder"===l.type,name:l.name,level:r,disabled:l.disabled,key:l.key,type:l.type,parent:l.parent};return _.name=l.name,_.disabled=l.disabled,_.parent=l.parent,_.url=l.url,_.desc=l.desc,_.orderNum=l.orderNum,_.expandable="folder"===l.type,this.flatNodeMap.set(_,l),this.nestedNodeMap.set(l,_),_},this.isCheckAll=!1,this.typeTable="button",this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectListSelection=new Oe.Ov,this.treeControl=new Ue.C2(l=>l.level,l=>l.expandable),this.treeFlattener=new C.T$(this.transformer,l=>l.level,l=>l.expandable,l=>l.children),this.setOfCheckedId=new Set,this.dataSource=new C.uF(this.treeControl,this.treeFlattener),this.listButton=[],this.listFormItem=[],this.listGrid=[],this.listRole=[]}getMenuTree(){this._systemRolePageAuthorityService.getMenuTree(this.selectedRole.id).subscribe(({data:t})=>{this.treeData=t.map(n=>({parent:n.parentMenuId,type:n.isMenu?"folder":"page",disabled:!n.isAuthority,name:n.menuPageName,url:n.menuPageUrl,desc:n.menuPageDescription,orderNum:n.menuPageOrderByNumber,key:n.menuPageId,iconName:n.iconName,children:[]})),this.treeData=this.listToTree(this.treeData),this.dataSource.setData(this.treeData),this.treeControl.expandAll()})}listToTree(t){let i,l,n={},s=[];for(l=0;l<t.length;l+=1)n[t[l].name]=l,t[l].children=[];for(l=0;l<t.length;l+=1)i=t[l],"_"!==i.parent?t[n[i.parent]].children.push(i):s.push(i);return s}onItemChecked(t,n){this.updateCheckedSet(t,n)}disableNode(){let t=this.flatNodeMap.get(this.selectedNode),n=!t.disabled;this.getAncestors(this.treeData,this.selectedNode.key).forEach((l,r)=>{n||(l.disabled=!1)});const s=(l,r)=>{l.disabled=r,l.children&&l.children.forEach(m=>{s(m,r)})};s(t,n),this.dataSource.setData(this.treeData)}checkAll(t){switch(this.typeTable){case"grid":this.listGrid.forEach(({itemId:n})=>this.updateCheckedSet(n,t));break;case"button":this.listButton.forEach(({itemId:n})=>this.updateCheckedSet(n,t));break;case"formItem":this.listFormItem.forEach(({itemId:n})=>this.updateCheckedSet(n,t))}}updateCheckedSet(t,n){n?this.setOfCheckedId.add(t):this.setOfCheckedId.delete(t)}openRoleListPopup(){this._dialog.open(Ee,{disableClose:!0,data:{}}).afterClosed().subscribe(()=>{this.getRole()})}openRoleCopyPopup(){this._dialog.open(ke,{disableClose:!0,data:this.selectedRole})}selectingNode(t){this.selectedNode=t,this.setOfCheckedId.clear(),this._systemRolePageAuthorityService.getDetailUi(this.selectedRole.id,this.selectedNode.key).subscribe(({data:n})=>{this.setOfCheckedId=new Set(n)}),this._menuPageService.getMenuDetailUi(this.selectedNode.key).subscribe(n=>{this.listButton=n.data.filter(i=>"BTN"===i.itemTypeCode),this.listFormItem=n.data.filter(i=>"BTN"!==i.itemTypeCode&&"COL"!==i.itemTypeCode),this.listGrid=n.data.filter(i=>"COL"===i.itemTypeCode)})}ngOnInit(){this.getRole()}getRole(){this._roleService.get().subscribe(({data:t})=>{this.listRole=t.map(n=>({id:n.roleId,name:n.roleName}))})}ngOnDestroy(){}getAncestors(t,n){if(typeof t<"u")for(let i=0;i<t.length;i++){if(t[i].key===n)return[t[i]];let s=this.getAncestors(t[i].children,n);if(null!==s)return s.unshift(t[i]),s}return null}saveDetail(){this._systemRolePageAuthorityService.updateTreeMenu(this.selectedRole.id,this.convertTreeToArr()).subscribe()}convertTreeToArr(){let t=[];const n=(i,s)=>{i.forEach(function(l){l.children&&l.children.length>0?(s.push({...l,children:[]}),n(l.children,s)):s.push(l)})};return n(this.treeData,t),t.map(i=>({parentMenuId:i.parent,menuPageName:i.name,menuPageDescription:i.desc,menuPageUrl:i.url,menuPageOrderByNumber:i.orderNum,isMenu:"folder"===i.type,isUse:!i.disabled,isDelete:!1,menuPageId:i.key,isAuthority:!i.disabled}))}updateTypeTable(t){switch(t){case 0:this.typeTable="button";break;case 1:this.typeTable="formItem";break;case 2:this.typeTable="grid"}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(J),e.Y36(F),e.Y36(q.N),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-ui-button-authority"]],decls:22,vars:12,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col"],[1,"flex","flex-col","sm:flex-row","bg-card","border-b","dark:bg-transparent","mb-6","px-6","items-start","sm:items-center","sm:py-4","md:px-8","sm:justify-between","shadow"],[1,"leading-none","text-3xl","font-bold","tracking-tight"],["mat-flat-button","","class","w-min",3,"color","click",4,"ngIf"],[1,"flex","flex-col","gap-4","sm:flex-row","bg-card","py-4","px-4","overflow-hidden","shadow","rounded-md","mx-6"],[1,"flex","flex-col","sm:flex-row","justify-between","w-full","items-center"],[1,"w-min","flex","flex-col","sm:flex-row","items-center","space-x-5"],["placeholder","system.role",1,"flex-1","w-60",3,"combineModel","listData","callbackChange","combineModelChange"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","system.roleList",1,"pl-2"],[1,"ml-auto"],["transloco","system.copyRole",1,"pl-2"],[1,"flex-2"],["class","my-6 px-6 grid grid-cols-1 sm:grid-cols-12 sm:space-x-4 space-y-4 sm:space-y-0 overflow-y-auto",4,"ngIf"],["tree",""],["transloco","save"],[1,"my-6","px-6","grid","grid-cols-1","sm:grid-cols-12","sm:space-x-4","space-y-4","sm:space-y-0","overflow-y-auto"],[1,"col-span-1","sm:col-span-5","rounded-md","shadow"],[1,"py-3","px-4","bg-gray-200","font-semibold","text-xl","flex","flex-row","justify-between","items-center"],[1,"bg-card"],[3,"ngTemplateOutlet",4,"ngIf"],[1,"col-span-1","sm:col-span-7"],["class","bg-card shadow rounded-md overflow-hidden ",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"bg-card","shadow","rounded-md","overflow-hidden"],[1,"py-5"],[1,"ml-6","mb-6",3,"color","ngModel","ngModelChange"],[1,"flex","flex-col","justify-between","max-h-screen-80","overflow-y-scroll","p-5"],[3,"nzTreeControl","nzDataSource"],["nzTreeNodeIndentLine","",4,"nzTreeNodeDef"],["nzTreeNodeIndentLine",""],[4,"ngIf"],[3,"nzSelected","click","nzClick"],[1,"flex"],["aria-hidden","false","aria-label","",3,"ngClass","svgIcon"],[1,"ml-1",3,"ngClass"],["nz-icon","","nzType","caret-down","nzTreeNodeToggleRotateIcon",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4),e.ALo(5,"transloco"),e.qZA(),e.YNc(6,He,2,1,"button",4),e.qZA(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"cm-select",8),e.NdJ("combineModelChange",function(s){return n.selectedRole=s}),e.qZA(),e.TgZ(11,"button",9),e.NdJ("click",function(){return n.openRoleListPopup()}),e._UZ(12,"mat-icon",10)(13,"label",11),e.qZA()(),e.TgZ(14,"div",12)(15,"button",9),e.NdJ("click",function(){return n.openRoleCopyPopup()}),e._UZ(16,"mat-icon",10)(17,"label",13),e.qZA()()(),e._UZ(18,"div",14),e.qZA(),e.YNc(19,We,10,5,"div",15),e.qZA()(),e.YNc(20,nt,3,2,"ng-template",null,16,e.W1O)),2&t&&(e.xp6(4),e.hij(" ",e.lcZ(5,10,"nav.uiButtonAuthority"),""),e.xp6(2),e.Q6J("ngIf",n.selectedNode),e.xp6(4),e.Q6J("combineModel",n.selectedRole)("listData",n.listRole)("callbackChange",n.getMenuTree.bind(n)),e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","menu"),e.xp6(3),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","content_copy"),e.xp6(3),e.Q6J("ngIf",n.selectedRole))},dependencies:[g.mk,g.O5,g.tP,v.JJ,v.On,Ye.w,p.KI,Be.Ls,Ke.Rr,y.Hw,f.lW,C.f_,C.kY,C.cm,C.V_,C.e1,C.nR,C.wS,A.f,p.Ot],encapsulation:2}),o})();var O=c(66525),ot=c(40536),U=c(46962),B=c(87016);let st=(()=>{class o extends Z.Y{constructor(t,n,i,s,l,r){super(null,null,l),this._translocoService=t,this._fuseConfirmService=n,this._samlService=i,this._workspaceService=s,this.dialogRef=l,this.data=r,this.samlReq={certificate:"",identityProviderIssuer:"",signInUrl:"",tenantId:"",verifiedDomain:""},this.selectTenants=[],this._unsubscribeAll=new D.x,this.exceptTenantIds=[],r.tenantIds&&(this.exceptTenantIds=r.tenantIds)}ngOnInit(){this.getData()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}getData(){this._workspaceService.get(this.exceptTenantIds).pipe((0,b.R)(this._unsubscribeAll)).subscribe(({data:t})=>{t&&(this.selectTenants=t.map(n=>({id:n.id,name:n.name})))})}onClickSave(){""!==this.samlReq.tenantId&&null!=this.samlReq.tenantId&&""!==this.samlReq.certificate&&""!==this.samlReq.identityProviderIssuer&&""!==this.samlReq.signInUrl&&""!==this.samlReq.verifiedDomain?this._samlService.create(this.samlReq).pipe((0,b.R)(this._unsubscribeAll)).subscribe(()=>{(0,h.Hh)(this._fuseConfirmService,this._translocoService.translate("message.success")).afterClosed().pipe((0,b.R)(this._unsubscribeAll)).subscribe(()=>{this.dialogRef.close("success")})}):(0,h.OJ)(this._fuseConfirmService,this._translocoService.translate("error"),this._translocoService.translate("message.mustInputRequired"))}onClickExit(){this.dialogRef.close("close")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.Vn),e.Y36(x.R),e.Y36(U.h),e.Y36(B.A),e.Y36(u.so),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-sso-config-create-popup"]],features:[e.qOj],decls:30,vars:14,consts:[[1,"w-full","max-w-3xl"],[1,"space-y-8","pb-3"],[1,"space-y-2"],[1,"text-right"],["mat-flat-button","",1,"rounded-full",3,"click"],["svgIcon","heroicons_solid:x-mark"],[1,"text-xl","font-medium"],[1,"text-slate-500","mb-4"],[1,"my-10","border-t"],[1,"w-full","flex-col","space-y-3"],[1,"flex-1"],[1,"flex-1",3,"listData","model","label","modelChange"],["type","text","isDisableLength","true",3,"model","label","modelChange"],["type","textarea","isDisableLength","true",3,"model","label","modelChange"],[1,"flex","space-x-2","justify-end"],["mat-flat-button","",1,"bg-slate-200",3,"click"],["transloco","cancel",1,"text-base","leading-6","font-medium","cursor-pointer"],["mat-flat-button","","color","primary",3,"click"],["transloco","save",1,"text-base","leading-6","font-medium","cursor-pointer"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div")(5,"div",3)(6,"button",4),e.NdJ("click",function(){return n.onClickExit()}),e._UZ(7,"mat-icon",5),e.qZA()(),e.TgZ(8,"div",6),e._uU(9," SAML SSO "),e.qZA(),e.TgZ(10,"div",7),e._uU(11),e.ALo(12,"transloco"),e.qZA()()()(),e._UZ(13,"div",8),e.TgZ(14,"div",9)(15,"div",10)(16,"cm-select",11),e.NdJ("modelChange",function(s){return n.samlReq.tenantId=s}),e.qZA()(),e.TgZ(17,"div",10)(18,"cm-input",12),e.NdJ("modelChange",function(s){return n.samlReq.verifiedDomain=s}),e.qZA()(),e.TgZ(19,"div",10)(20,"cm-input",12),e.NdJ("modelChange",function(s){return n.samlReq.signInUrl=s}),e.qZA()(),e.TgZ(21,"div",10)(22,"cm-input",12),e.NdJ("modelChange",function(s){return n.samlReq.identityProviderIssuer=s}),e.qZA()(),e.TgZ(23,"div",10)(24,"cm-input",13),e.NdJ("modelChange",function(s){return n.samlReq.certificate=s}),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.onClickExit()}),e._UZ(27,"label",16),e.qZA(),e.TgZ(28,"button",17),e.NdJ("click",function(){return n.onClickSave()}),e._UZ(29,"label",18),e.qZA()()()),2&t&&(e.xp6(11),e.hij(" ",e.lcZ(12,12,"system.ssoSettingsDescription")," "),e.xp6(5),e.Q6J("listData",n.selectTenants)("model",n.samlReq.tenantId)("label","Tenant"),e.xp6(2),e.Q6J("model",n.samlReq.verifiedDomain)("label","Verified Domain"),e.xp6(2),e.Q6J("model",n.samlReq.signInUrl)("label","SAML Sign-In Url"),e.xp6(2),e.Q6J("model",n.samlReq.identityProviderIssuer)("label","Identity Provider Issuer"),e.xp6(2),e.Q6J("model",n.samlReq.certificate)("label","Key x509 Certificate"))},dependencies:[p.KI,y.Hw,f.lW,A.f,N.W,p.Ot],encapsulation:2}),o})();function lt(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"cm-input",12),e.NdJ("modelChange",function(i){e.CHM(t);const s=e.oxw();return e.KtG(s.samlReq.tenantId=i)}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("actionEnum",t.actionEnums)("model",t.samlReq.tenantId)("label","Tenant")}}function at(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"button",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onClickExit())}),e._UZ(2,"label",17),e.qZA(),e.TgZ(3,"button",18),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onClickSave())}),e._UZ(4,"label",19),e.qZA()()}}let rt=(()=>{class o extends Z.Y{constructor(t,n,i,s,l,r){super(null,null,l),this._translocoService=t,this._samlService=n,this._fuseConfirmService=i,this._workspaceService=s,this.dialogRef=l,this.data=r,this.samlReq={certificate:"",identityProviderIssuer:"",signInUrl:"",tenantId:"",verifiedDomain:""},this.actionEnums="view",this.selectTenants=[],this._unsubscribeAll=new D.x,this.exceptTenantIds=[],r.saml&&(this.samlReq=r.saml),r.tenantId&&(this.samlReq.tenantId=r.tenantId),r.actionEnums&&(this.actionEnums=r.actionEnums)}ngOnInit(){this.getData()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}getData(){this._workspaceService.get(this.exceptTenantIds).pipe((0,b.R)(this._unsubscribeAll)).subscribe(({data:t})=>{t&&(this.selectTenants=t.map(n=>({id:n.id,name:n.name})))})}onClickSave(){""!==this.samlReq.tenantId&&null!=this.samlReq.tenantId&&""!==this.samlReq.certificate&&""!==this.samlReq.identityProviderIssuer&&""!==this.samlReq.signInUrl&&""!==this.samlReq.verifiedDomain?this._samlService.update(this.samlReq.tenantId,this.samlReq).pipe((0,b.R)(this._unsubscribeAll)).subscribe(()=>{(0,h.Hh)(this._fuseConfirmService,this._translocoService.translate("message.success")).afterClosed().pipe((0,b.R)(this._unsubscribeAll)).subscribe(()=>{this.dialogRef.close("success")})}):(0,h.OJ)(this._fuseConfirmService,this._translocoService.translate("error"),this._translocoService.translate("message.mustInputRequired"))}onClickExit(){this.dialogRef.close("close")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.Vn),e.Y36(U.h),e.Y36(x.R),e.Y36(B.A),e.Y36(u.so),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-sso-config-update-popup"]],features:[e.qOj],decls:25,vars:17,consts:[[1,"w-full","max-w-3xl"],[1,"space-y-8","pb-3"],[1,"space-y-2"],[1,"text-right"],["mat-flat-button","",1,"rounded-full",3,"click"],["svgIcon","heroicons_solid:x-mark"],[1,"text-xl","font-medium"],[1,"text-slate-500","mb-4"],[1,"my-10","border-t"],[1,"w-full","flex-col","space-y-3"],["class","flex-1",4,"ngIf"],[1,"flex-1"],["type","text","isDisableLength","true",3,"actionEnum","model","label","modelChange"],["type","textarea","isDisableLength","true",3,"actionEnum","model","label","modelChange"],["class","flex space-x-2 justify-end",4,"ngIf"],[1,"flex","space-x-2","justify-end"],["mat-flat-button","",1,"bg-slate-200",3,"click"],["transloco","cancel",1,"text-base","leading-6","font-medium","cursor-pointer"],["mat-flat-button","","color","primary",3,"click"],["transloco","save",1,"text-base","leading-6","font-medium","cursor-pointer"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div")(5,"div",3)(6,"button",4),e.NdJ("click",function(){return n.onClickExit()}),e._UZ(7,"mat-icon",5),e.qZA()(),e.TgZ(8,"div",6),e._uU(9," SAML SSO "),e.qZA(),e.TgZ(10,"div",7),e._uU(11),e.ALo(12,"transloco"),e.qZA()()()(),e._UZ(13,"div",8),e.TgZ(14,"div",9),e.YNc(15,lt,2,3,"div",10),e.TgZ(16,"div",11)(17,"cm-input",12),e.NdJ("modelChange",function(s){return n.samlReq.verifiedDomain=s}),e.qZA()(),e.TgZ(18,"div",11)(19,"cm-input",12),e.NdJ("modelChange",function(s){return n.samlReq.signInUrl=s}),e.qZA()(),e.TgZ(20,"div",11)(21,"cm-input",12),e.NdJ("modelChange",function(s){return n.samlReq.identityProviderIssuer=s}),e.qZA()(),e.TgZ(22,"div",11)(23,"cm-input",13),e.NdJ("modelChange",function(s){return n.samlReq.certificate=s}),e.qZA()()()(),e.YNc(24,at,5,0,"div",14),e.qZA()),2&t&&(e.xp6(11),e.hij(" ",e.lcZ(12,15,"system.ssoSettingsDescription")," "),e.xp6(4),e.Q6J("ngIf","view"==n.actionEnums),e.xp6(2),e.Q6J("actionEnum",n.actionEnums)("model",n.samlReq.verifiedDomain)("label","Verified Domain"),e.xp6(2),e.Q6J("actionEnum",n.actionEnums)("model",n.samlReq.signInUrl)("label","SAML Sign-In Url"),e.xp6(2),e.Q6J("actionEnum",n.actionEnums)("model",n.samlReq.identityProviderIssuer)("label","Identity Provider Issuer"),e.xp6(2),e.Q6J("actionEnum",n.actionEnums)("model",n.samlReq.certificate)("label","Key x509 Certificate"),e.xp6(1),e.Q6J("ngIf","edit"==n.actionEnums))},dependencies:[g.O5,p.KI,y.Hw,f.lW,N.W,p.Ot],encapsulation:2}),o})();var R=c(17406),ct=c(83649);function dt(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"span",13)(3,"button",14)(4,"mat-icon"),e._uU(5," more_vert "),e.qZA(),e.TgZ(6,"mat-menu",null,15),e.ynx(8),e.TgZ(9,"button",16),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onUpdateOrViewClick(s,"view"))}),e.TgZ(10,"mat-icon"),e._uU(11,"visibility"),e.qZA(),e._uU(12),e.ALo(13,"transloco"),e.qZA(),e.TgZ(14,"button",16),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onUpdateOrViewClick(s,"edit"))}),e.TgZ(15,"mat-icon"),e._uU(16,"edit"),e.qZA(),e._uU(17),e.ALo(18,"transloco"),e.qZA(),e.BQk(),e.qZA()()()(),e.TgZ(19,"td",17),e._uU(20),e.qZA(),e.TgZ(21,"td",18),e._uU(22),e.qZA(),e.TgZ(23,"td",18),e._uU(24),e.qZA(),e.TgZ(25,"td",18),e._uU(26),e.qZA(),e.TgZ(27,"td",18),e._uU(28),e.qZA(),e.TgZ(29,"td",18),e._uU(30),e.qZA()()}if(2&o){const t=a.$implicit,n=a.index,i=e.MAs(7);e.oxw();const s=e.MAs(13);e.xp6(3),e.Q6J("matMenuTriggerFor",i),e.xp6(9),e.hij(" ",e.lcZ(13,14,"view")," "),e.xp6(5),e.hij(" ",e.lcZ(18,16,"edit")," "),e.xp6(3),e.Oqu((s.nzPageIndex-1)*s.nzPageSize+n+1),e.xp6(1),e.Q6J("matTooltip",t.verifiedDomain),e.xp6(1),e.Oqu(t.tenantName),e.xp6(1),e.Q6J("matTooltip",t.verifiedDomain),e.xp6(1),e.Oqu(t.verifiedDomain),e.xp6(1),e.Q6J("matTooltip",t.signInUrl),e.xp6(1),e.Oqu(t.signInUrl),e.xp6(1),e.Q6J("matTooltip",t.identityProviderIssuer),e.xp6(1),e.hij("",t.identityProviderIssuer," "),e.xp6(1),e.Q6J("matTooltip",t.certificate),e.xp6(1),e.hij(" ",t.certificate,"")}}const pt=[{canActivate:[O.u],path:"pages",component:Ie},{canActivate:[O.u],path:"sso-configs",component:(()=>{class o{constructor(t,n,i){this._dialog=t,this._samlService=n,this._fuseConfirmationService=i,this.data=[],this.oldData=[],this.tenantIds=[],this.loading=!1,this._unsubscribeAll=new D.x,this.getData()}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}getData(){this.loading=!0,this._samlService.getAll().pipe((0,b.R)(this._unsubscribeAll)).subscribe(({data:t})=>{this.data=[...t],this.tenantIds=t.map(n=>n.tenantId),this.loading=!1,this.oldData=(0,S.cloneDeep)(this.data)})}onCreateClick(){this._dialog.open(st,{data:{tenantIds:this.tenantIds}}).afterClosed().pipe((0,b.R)(this._unsubscribeAll)).subscribe(n=>{"close"==n&&(this.data=this.oldData,this.oldData=(0,S.cloneDeep)(this.data)),"success"==n&&this.getData()})}onUpdateOrViewClick(t,n){this._dialog.open(rt,{data:{saml:t,actionEnums:n}}).afterClosed().pipe((0,b.R)(this._unsubscribeAll)).subscribe(s=>{"close"==s&&(this.data=this.oldData,this.oldData=(0,S.cloneDeep)(this.data)),"success"==s&&this.getData()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.uw),e.Y36(U.h),e.Y36(x.R))},o.\u0275cmp=e.Xpm({type:o,selectors:[["system-sso-config"]],decls:30,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","sm:justify-between","mb-6","px-6","sm:py-4","md:px-8","border-b","bg-card","dark:bg-transparent"],[1,"text-3xl","font-bold","tracking-tight","leading-none"],["mat-flat-button","","color","primary",3,"click"],[1,"mx-6"],[1,"w-full"],[1,"p-6","bg-card","shadow","rounded-md","overflow-hidden"],[1,"flex","flex-row","gap-2"],["nzBordered","","nzShowSizeChanger","",1,"w-full",3,"nzData","nzLoading"],["basicTable",""],["nzWidth","60px"],["transloco","no","nzAlign","center","nzWidth","66px"],[4,"ngFor","ngForOf"],[1,"items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],["headerMenu",""],["mat-menu-item","",3,"click"],["nzAlign","center"],[1,"truncate","max-w-40",3,"matTooltip"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"transloco"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return n.onCreateClick()}),e._uU(6),e.ALo(7,"transloco"),e.qZA()(),e.TgZ(8,"div",4)(9,"div",5)(10,"div",6),e._UZ(11,"div",7),e.TgZ(12,"nz-table",8,9)(14,"thead")(15,"tr"),e._UZ(16,"th",10)(17,"th",11),e.TgZ(18,"th"),e._uU(19,"Tenant Name"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"VerifiedDomain"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"SignInUrl"),e.qZA(),e.TgZ(24,"th"),e._uU(25,"IdentityProviderIssuer"),e.qZA(),e.TgZ(26,"th"),e._uU(27,"Certificate"),e.qZA()()(),e.TgZ(28,"tbody"),e.YNc(29,dt,31,18,"tr",12),e.qZA()()()()()()),2&t){const i=e.MAs(13);e.xp6(3),e.hij(" ",e.lcZ(4,5,"nav.menuDetail")," "),e.xp6(3),e.Oqu(e.lcZ(7,7,"add")),e.xp6(6),e.Q6J("nzData",n.data)("nzLoading",n.loading),e.xp6(17),e.Q6J("ngForOf",i.data)}},dependencies:[g.sg,p.KI,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,d.UX,y.Hw,f.lW,f.RK,R.VK,R.OP,R.p6,ct.gM,p.Ot],encapsulation:2}),o})()},{canActivate:[O.u],path:"defined-items",component:qe},{canActivate:[ot.t],path:"page-button-authorities",component:it}];let ut=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[{provide:u.WI,useValue:{}},{provide:u.so,useValue:{}},{provide:Q.u7,useValue:Q.iF}],imports:[$.Bz.forChild(pt),X.m,V,H.lN,j.c,K.p9,d.HQ,P.vO,ee.qw,v.u5]}),o})()}}]);