"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[859],{85859:(Nt,H,s)=>{s.r(H),s.d(H,{TicketHauntModule:()=>yt});var p=s(44755),b=s(39401),g=s(51728),Q=s(11292),m=s(25580),I=s(99114),C=s(430),M=s(69609),T=s(17406),R=s(50877),Y=s(13617),F=s(83649),v=s(31531),E=s(74473),u=s(30430),q=s(61972),N=s(22497),w=s(74050),d=s(58016),W=s(56467),K=s(12965),t=s(22223);let G=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["ticket-haunt"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},dependencies:[v.lC],encapsulation:2}),n})();var X=s(15439),L=s.n(X),h=s(77579),$=s(78372),r=s(82722),x=s(28746),J=s(12017),tt=s(15861),et=s(45840),f=s(61135),it=s(32076),_=s(96119),nt=s(42198),k=s(82004),Z=s(71683),j=s(79925),at=s(18505),ot=s(3144);let U=(()=>{class n{constructor(e,i){this._httpClient=e,this._fuseConfirmationService=i}getAll(e){return this._httpClient.get("api/ticket-haunts",{params:{...e}})}create(e){return this._httpClient.post("api/ticket-haunts",e)}getById(e){return this._httpClient.get(`api/ticket-haunts/${encodeURIComponent(e)}`)}checkOut(e){return this._httpClient.patch(`api/ticket-haunts/${encodeURIComponent(e)}/check-out`,null).pipe((0,at.b)(({success:i})=>{i&&(0,k.Hh)(this._fuseConfirmationService)}))}getVisitorStatus(){return this._httpClient.get("api/ticket-haunts/visitor-statuses")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(ot.eN),t.LFG(Z.R))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var st=s(38642),lt=s(85450),ct=s(61148),rt=s(32202),ut=s(92369),O=s(47148),D=s(90504),y=s(44867);function mt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"cm-select",40),t.NdJ("modelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.data.companyId=a)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("actionEnum","create"!==e.action?"view":"new")("listData",e.listCompanies)("model",e.data.companyId)}}function dt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"cm-select",41),t.NdJ("modelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.data.apartmentId=a)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("actionEnum","create"!==e.action?"view":"new")("listData",e.listApartments)("model",e.data.apartmentId)}}function pt(n,l){1&n&&t._UZ(0,"div",42)}function gt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"div",42)(1,"button",43),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.openBiostationConfig())}),t._UZ(2,"mat-icon",44),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"transloco"),t.qZA()()()}2&n&&(t.xp6(1),t.Q6J("color","primary"),t.xp6(3),t.Oqu(t.lcZ(5,2,"vime.checkInOutSettings")))}function ht(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onProceedCheckin())}),t._UZ(1,"label",46),t.qZA()}2&n&&t.Q6J("color","primary")}function ft(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onProceedCheckOut(a.data.ticketHauntId))}),t.TgZ(1,"label"),t._uU(2,"Check-out"),t.qZA()()}2&n&&t.Q6J("color","primary")}let A=(()=>{class n extends J.Y{constructor(e,i,a,o,c,S,At,St,zt,Ht,Ft,z){super(a,i,e),this._dialogRef=e,this.fuseConfirmationService=i,this._translocoService=a,this._outsideCustomerService=o,this._ticketHauntService=c,this._companyService=S,this._apartmentService=At,this._customerTypeService=St,this._notificationService=zt,this._matDialog=Ht,this._uploadService=Ft,this.w=window,this._unsubscribeAll=new h.x,this.listVisitor=[],this.listCompanies=[],this.listApartments=[],this.customerTypes=[],this.data={ticketHauntId:null,isCompany:!0,isApartment:!1,companyId:null,companyName:null,apartmentId:null,apartmentCode:null,content:null,arrivalTime:null,departureTime:null,isVisitor:!1,statusId:null,statusName:null,statusColor:null,statusBackgroundColor:null,outsideCustomerId:null,fullName:null,phoneNumber:null,email:null,citizenNumber:null,citizenFrontImage:null,citizenBackImage:null,citizenImageFace:null,customerTypeId:null,customerTypeName:null,description:null},this.isLoading=!1,this.triggerIdentityBack=new h.x,this.triggerIdentityFront=new h.x,this.triggerIdentityFaceImage=new h.x,this.frontCardImageSubject=new f.X(null),this.backCardImageSubject=new f.X(null),this.citizenImageFaceSubject=new f.X(null),this.guestFrontCardImageSubject=new f.X(null),this.guestBackCardImageSubject=new f.X(null),this.guestFaceImageSubject=new f.X(null),this.isShowWebcamIdentityCardFront=!1,this.isShowWebcamIdentityCardBack=!1,this.isShowWebcamIdentityGuestFaceImage=!1,this.errors=[],this.selectedVisitor=z.selectedVisitor,this.ticketHauntId=z.ticketHauntId,this.action=z.action}ngOnInit(){"create"===this.action?this.getDetailWithVisitor(this.selectedVisitor):("view"===this.action||"check-out"===this.action)&&this.getDetail(this.ticketHauntId),this.getMasterData(),this.selectedOption=this.data.isCompany?"company":"apartment"}checkBattery(){(0,it.D)(window.MauiInterop.checkBattery()).subscribe(e=>{console.log(e),this.data.fullName=e.fullName,this.data.citizenNumber=e.identityNumber,this.handleImage("citizenBackImage",e.backImage),this.handleImage("citizenFrontImage",e.frontImage),this.handleImage("citizenImageFace",e.faceImage)})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}getDetailWithVisitor(e){(0,_.TF)(e)?this.initValue():(this.isLoading=!0,console.log(e),this._outsideCustomerService.getById(e).pipe((0,r.R)(this._unsubscribeAll),(0,x.x)(()=>this.isLoading=!1)).subscribe(({data:i})=>{this.data.ticketHauntId=null,this.data.isCompany=!0,this.data.isApartment=!1,this.data.companyId=null,this.data.companyName=null,this.data.apartmentId=null,this.data.apartmentCode=null,this.data.content=null,this.data.outsideCustomerId=i.outsideCustomerId,this.data.fullName=i.fullName,this.data.phoneNumber=i.phoneNumber,this.data.email=i.email,this.data.customerTypeId=i.customerTypeId,this.data.citizenNumber=i.citizenNumber,this.data.citizenFrontImage=i.citizenFrontImage,this.data.citizenBackImage=i.citizenBackImage,this.data.citizenImageFace=i.citizenImageFace,this.frontCardImageSubject.next(this.data.citizenFrontImage),this.backCardImageSubject.next(this.data.citizenBackImage),this.citizenImageFaceSubject.next(this.data.citizenImageFace),this.guestFrontCardImageSubject.next(this.data.citizenFrontImage),this.guestBackCardImageSubject.next(this.data.citizenBackImage),this.guestFaceImageSubject.next(this.data.citizenImageFace)}))}onCancel(){"create"===this.action?(0,k.WD)(this.fuseConfirmationService,this._translocoService.translate("message.confirmUnSaveChange"),this._translocoService.translate("message.unsavedChangesAreYouSure")).afterClosed().subscribe(e=>{"confirmed"===e&&this._baseDialogRef.close()}):this._baseDialogRef.close()}onProceedCheckin(){if((0,_.TF)(this.data.fullName)||(0,_.TF)(this.data.citizenNumber))return void this._notificationService.warning(this._translocoService.translate("warning"),this._translocoService.translate("message.mustInputRequired"),{nzDuration:3e3});const e={...this.data};console.log(e),this._ticketHauntService.create(e).pipe((0,r.R)(this._unsubscribeAll),(0,x.x)(()=>this.isLoading=!1)).subscribe(i=>{i&&((0,k.Hh)(this.fuseConfirmationService,"message.saveSuccess"),this.closePopup())})}onProceedCheckOut(e){this.isLoading=!0,this._ticketHauntService.checkOut(e).pipe((0,r.R)(this._unsubscribeAll),(0,x.x)(()=>this.isLoading=!1)).subscribe(({})=>{this.closePopup()})}onOptionChange(){"company"===this.selectedOption?(this.data.isCompany=!0,this.data.isApartment=!1):(this.data.isCompany=!1,this.data.isApartment=!0)}getDetail(e){this.isLoading=!0,this._ticketHauntService.getById(e).pipe((0,r.R)(this._unsubscribeAll),(0,x.x)(()=>this.isLoading=!1)).subscribe(({data:i})=>{this.data=(0,et.Z)(i),this.frontCardImageSubject.next(this.data.citizenFrontImage),this.backCardImageSubject.next(this.data.citizenBackImage),this.citizenImageFaceSubject.next(this.data.citizenImageFace),this.guestFrontCardImageSubject.next(this.data.citizenFrontImage),this.guestBackCardImageSubject.next(this.data.citizenBackImage),this.guestFaceImageSubject.next(this.data.citizenImageFace),console.log(this.data)})}getCompanyNames(){this._companyService.get().pipe((0,r.R)(this._unsubscribeAll)).subscribe(({data:e})=>{this.listCompanies=e.map(i=>({id:i.companyId,name:i.companyName}))})}getApartmentCodes(){this._apartmentService.get().pipe((0,r.R)(this._unsubscribeAll)).subscribe(({data:e})=>{this.listApartments=e.map(i=>({id:i.apartmentId,name:i.apartmentCode}))})}getCustomerTypes(){this._customerTypeService.get({isUse:!0}).pipe((0,r.R)(this._unsubscribeAll)).subscribe(({data:e})=>{this.customerTypes=e.map(i=>({id:i.customerTypeId,name:i.typeName}))})}getMasterData(){this.getCompanyNames(),this.getApartmentCodes(),this.getCustomerTypes()}getTriggerObservable(e){switch(e){case"citizenFrontImage":return this.triggerIdentityFront.asObservable();case"citizenBackImage":return this.triggerIdentityBack.asObservable();case"citizenImageFace":return this.triggerIdentityFaceImage.asObservable()}}handleImage(e,i){var a=this;return(0,tt.Z)(function*(){const o=yield(yield fetch(`data:image/jpeg;base64,${i}`)).blob();a.currentFileUpload=new File([o],"image.jpg",{type:"image/jpeg"}),a.uploadImage().subscribe(({data:c})=>{switch(e){case"citizenFrontImage":a.data.citizenFrontImage=c;break;case"citizenBackImage":a.data.citizenBackImage=c;break;case"citizenImageFace":a.data.citizenImageFace=c}})})()}uploadImage(){return this._uploadService.upLoadFile(this.currentFileUpload)}deleteFile(e){switch(e){case"citizenFrontImage":this.frontCardImageSubject.next(null),this.guestFrontCardImageSubject.next(null);break;case"citizenBackImage":this.backCardImageSubject.next(null),this.guestBackCardImageSubject.next(null);break;case"citizenImageFace":this.citizenImageFaceSubject.next(null),this.guestFaceImageSubject.next(null)}}triggerSnapshot(e){switch(e){case"citizenFrontImage":this.triggerIdentityFront.next(),this.isShowWebcamIdentityCardFront=!1;break;case"citizenBackImage":this.triggerIdentityBack.next(),this.isShowWebcamIdentityCardBack=!1;break;case"citizenImageFace":this.triggerIdentityFaceImage.next(),this.isShowWebcamIdentityGuestFaceImage=!1}}onImportImageChange(e,i){const a=i.currentTarget;a.files.length&&(this.currentFileUpload=a.files[0],this.uploadImage().subscribe(({data:o})=>{switch(e){case"citizenFrontImage":this.data.citizenFrontImage=o,this.frontCardImageSubject.next(o),this.guestFrontCardImageSubject.next(o);break;case"citizenBackImage":this.data.citizenBackImage=o,this.backCardImageSubject.next(o),this.guestBackCardImageSubject.next(o);break;case"citizenImageFace":this.data.citizenImageFace=o,this.citizenImageFaceSubject.next(o),this.guestFaceImageSubject.next(o);break;default:return}}))}handleInitError(e){this.errors.push(e)}openBiostationConfig(){this._matDialog.open(nt.I,{disableClose:!1,data:{staffId:null,customerId:null,outsideCustomerId:this.data.outsideCustomerId??null}}).afterClosed().subscribe(i=>{i&&this.getDetailWithVisitor(this.data.outsideCustomerId)})}initValue(){this.data={ticketHauntId:null,isCompany:!0,isApartment:!1,companyId:null,companyName:null,apartmentId:null,apartmentCode:null,content:null,arrivalTime:null,departureTime:null,isVisitor:!1,statusId:null,statusName:null,statusColor:null,statusBackgroundColor:null,outsideCustomerId:null,fullName:null,phoneNumber:null,email:null,citizenNumber:null,citizenFrontImage:null,citizenBackImage:null,citizenImageFace:null,customerTypeId:null,customerTypeName:null,description:null},this.frontCardImageSubject.next(this.data.citizenFrontImage),this.backCardImageSubject.next(this.data.citizenBackImage),this.citizenImageFaceSubject.next(this.data.citizenImageFace),this.guestFrontCardImageSubject.next(this.data.citizenFrontImage),this.guestBackCardImageSubject.next(this.data.citizenBackImage),this.guestFaceImageSubject.next(this.data.citizenImageFace)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.so),t.Y36(Z.R),t.Y36(u.Vn),t.Y36(j.H),t.Y36(U),t.Y36(st.J),t.Y36(lt.V),t.Y36(ct.a),t.Y36(rt.zb),t.Y36(m.uw),t.Y36(ut.C),t.Y36(m.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ticket-haunt-popup"]],features:[t.qOj],decls:65,vars:45,consts:[[1,"flex","flex-col","flex-auto","md:w-auto","lg:min-w-240","-m-6","md:max-w-240"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],["transloco","master.registerVisitorTicket",1,"text-lg","font-medium","text-white"],["mat-icon-button","",3,"click"],[1,"icon-size-7","text-white",3,"svgIcon"],[1,"max-h-screen-80","max-w-screen-80","px-6","pt-6","pb-0","space-y-6","overflow-y-auto","bg-slate-100"],[1,"bg-card","rounded-md","p-6","gap-5","shadow","flex","flex-col","h-full"],[1,"pb-4","flex","border-b"],[1,"text-xl","font-medium"],[1,"flex","flex-row","sm:flex-col","p-6","gap-6"],[1,"flex","flex-1","flex-row","gap-6"],["color","primary",1,"space-x-10","sm:space-x-4",3,"disabled","ngModel","ngModelChange"],["value","company"],["value","apartment"],["label","master.company","class","flex-1",3,"actionEnum","listData","model","modelChange",4,"ngIf"],["label","master.apartment","class","flex-1",3,"actionEnum","listData","model","modelChange",4,"ngIf"],[1,"flex"],["label","master.reason/content","type","textarea","isDisableLength","true",1,"flex-1","w-full",3,"actionEnum","model","modelChange"],[1,"bg-card","rounded-md","px-6","pb-6","gap-5","shadow","flex","flex-col","h-full","ng-star-inserted"],[1,"flex","md:flex-row","flex-col","md:gap-4","gap-2.5","px-6","py-4"],["label","fullName","isDisableLength","true",1,"flex-1","w-full",3,"actionEnum","model","isRequired","modelChange"],["label","master.citizenNumber","isDisableLength","true",1,"flex-1","w-full",3,"model","actionEnum","isRequired","modelChange"],[1,"flex","md:flex-row","flex-col","md:gap-4","gap-2.5","px-6","pb-4"],["label","master.phoneNumber","isDisableLength","true",1,"flex-1","w-full",3,"actionEnum","model","modelChange"],["label","master.email","isDisableLength","true",1,"flex-1","w-full",3,"actionEnum","model","modelChange"],["label","master.customerGroup",1,"w-full",3,"actionEnum","listData","model","modelChange"],["mat-flat-button","","color","primary",3,"click"],["transloco","vime.getImageFromReader"],[1,"bg-card","rounded-md","px-6","pb-6","gap-5","shadow","flex","flex-col","sm:flex-row","justify-between","sm:gap-4","h-full"],[1,"w-full","text-center","font-bold","py-2"],[1,"w-full","justify-center","items-center","font-bold","pb-2"],[1,"flex-1","border-2","border-dashed","border-primary-300","bg-primary-50","rounded-lg","w-full","h-[140px]","flex","items-center","justify-center"],[1,"flex","items-center","justify-center"],["nz-image","",1,"object-fit","h-[140px]","w-[500px]","rounded-md",2,"object-fit","contain","width","500px","height","140px",3,"nzSrc"],[1,"flex","space-x-2","px-10","py-5","justify-between"],["class","flex justify-start",4,"ngIf"],[1,"flex","flex-row","justify-end","space-x-4"],["mat-button","",3,"click"],["transloco","close",1,"text-base","leading-6","font-medium","cursor-pointer"],["mat-flat-button","","class","w-min",3,"color","click",4,"ngIf"],["label","master.company",1,"flex-1",3,"actionEnum","listData","model","modelChange"],["label","master.apartment",1,"flex-1",3,"actionEnum","listData","model","modelChange"],[1,"flex","justify-start"],["mat-flat-button","",1,"gap-2",3,"color","click"],["svgIcon","heroicons_solid:cog-6-tooth",1,"icon-size-5"],["mat-flat-button","",1,"w-min",3,"color","click"],["transloco","master.proceedCheckIn"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return i.onCancel()}),t._UZ(4,"mat-icon",4),t.qZA()(),t.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"span",8),t._uU(9),t.ALo(10,"transloco"),t.qZA()(),t.TgZ(11,"div",9)(12,"div",10)(13,"mat-radio-group",11),t.NdJ("ngModelChange",function(o){return i.selectedOption=o})("ngModelChange",function(){return i.onOptionChange()}),t.TgZ(14,"mat-radio-button",12),t._uU(15),t.ALo(16,"transloco"),t.qZA(),t.TgZ(17,"mat-radio-button",13),t._uU(18),t.ALo(19,"transloco"),t.qZA()(),t.YNc(20,mt,1,3,"cm-select",14),t.YNc(21,dt,1,3,"cm-select",15),t.qZA(),t.TgZ(22,"div",16)(23,"cm-input",17),t.NdJ("modelChange",function(o){return i.data.content=o}),t.qZA()()()(),t.TgZ(24,"div",18)(25,"div",19)(26,"cm-input",20),t.NdJ("modelChange",function(o){return i.data.fullName=o}),t.qZA(),t.TgZ(27,"cm-input",21),t.NdJ("modelChange",function(o){return i.data.citizenNumber=o}),t.qZA()(),t.TgZ(28,"div",22)(29,"cm-input",23),t.NdJ("modelChange",function(o){return i.data.phoneNumber=o}),t.qZA(),t.TgZ(30,"cm-input",24),t.NdJ("modelChange",function(o){return i.data.email=o}),t.qZA()(),t.TgZ(31,"div",22)(32,"cm-select",25),t.NdJ("modelChange",function(o){return i.data.customerTypeId=o}),t.qZA()(),t.TgZ(33,"button",26),t.NdJ("click",function(){return i.checkBattery()}),t._UZ(34,"label",27),t.qZA()(),t.TgZ(35,"div",28)(36,"div",29)(37,"div",30),t._uU(38),t.ALo(39,"transloco"),t.qZA(),t.TgZ(40,"div",31)(41,"div",32),t._UZ(42,"img",33),t.qZA()()(),t.TgZ(43,"div",29)(44,"div",30),t._uU(45),t.ALo(46,"transloco"),t.qZA(),t.TgZ(47,"div",31)(48,"div",32),t._UZ(49,"img",33),t.qZA()()(),t.TgZ(50,"div",29)(51,"div",30),t._uU(52),t.ALo(53,"transloco"),t.qZA(),t.TgZ(54,"div",31)(55,"div",32),t._UZ(56,"img",33),t.qZA()()()()(),t.TgZ(57,"div",34),t.YNc(58,pt,1,0,"div",35),t.YNc(59,gt,6,4,"div",35),t.TgZ(60,"div",36)(61,"button",37),t.NdJ("click",function(){return i.onCancel()}),t._UZ(62,"label",38),t.qZA(),t.YNc(63,ht,2,1,"button",39),t.YNc(64,ft,3,1,"button",39),t.qZA()()()),2&e&&(t.xp6(4),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(5),t.Oqu(t.lcZ(10,33,"master.ticketInfo")),t.xp6(4),t.Q6J("disabled","create"!==i.action)("ngModel",i.selectedOption),t.xp6(2),t.Oqu(t.lcZ(16,35,"master.company")),t.xp6(3),t.Oqu(t.lcZ(19,37,"master.apartment")),t.xp6(2),t.Q6J("ngIf",i.data.isCompany),t.xp6(1),t.Q6J("ngIf",i.data.isApartment),t.xp6(2),t.Q6J("actionEnum","create"!==i.action?"view":"new")("model",i.data.content),t.xp6(3),t.Q6J("actionEnum","create"!==i.action?"view":"new")("model",i.data.fullName)("isRequired",!0),t.xp6(1),t.Q6J("model",i.data.citizenNumber)("actionEnum",null==i.data.outsideCustomerId?"new":"view")("isRequired",!0),t.xp6(2),t.Q6J("actionEnum","create"!==i.action?"view":"new")("model",i.data.phoneNumber),t.xp6(1),t.Q6J("actionEnum","create"!==i.action?"view":"new")("model",i.data.email),t.xp6(2),t.Q6J("actionEnum","create"!==i.action?"view":"new")("listData",i.customerTypes)("model",i.data.customerTypeId),t.xp6(6),t.hij(" ",t.lcZ(39,39,"vime.citizenImageFace")," "),t.xp6(4),t.Q6J("nzSrc","https://localhost:5001"+i.data.citizenImageFace),t.xp6(3),t.hij(" ",t.lcZ(46,41,"vime.citizenFrontImage")," "),t.xp6(4),t.Q6J("nzSrc","https://localhost:5001"+i.data.citizenFrontImage),t.xp6(3),t.hij(" ",t.lcZ(53,43,"vime.citizenBackImage")," "),t.xp6(4),t.Q6J("nzSrc","https://localhost:5001"+i.data.citizenBackImage),t.xp6(2),t.Q6J("ngIf","view"!==i.action),t.xp6(1),t.Q6J("ngIf","view"===i.action),t.xp6(4),t.Q6J("ngIf","create"===i.action),t.xp6(1),t.Q6J("ngIf","check-out"===i.action))},dependencies:[g.lW,g.RK,C.Hw,b.JJ,b.On,u.KI,w.Ie,p.O5,O.f,D.W,y.VQ,y.U0,u.Ot],encapsulation:2}),n})();var V=s(50787),bt=s(1217),P=s(33231),Ct=s(70391);function xt(n,l){if(1&n&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&n){const e=l.$implicit;t.Q6J("value",e.id),t.xp6(1),t.AsE(" [",e.description,"] - ",e.name," ")}}let Tt=(()=>{class n extends J.Y{constructor(e,i,a,o,c){super(a,i,e),this._dialogRef=e,this.fuseConfirmationService=i,this._translocoService=a,this._matDialog=o,this._unsubscribeAll=new h.x,this.isLoading=!1,this.selectedVisitor=null,this.listVisitor=c.listVisitor}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onProceed(){this._matDialog.open(A,{disableClose:!0,data:{selectedVisitor:this.selectedVisitor,action:"create"}}).afterClosed().subscribe(i=>{this.closePopup()})}onCancel(){this._baseDialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.so),t.Y36(Z.R),t.Y36(u.Vn),t.Y36(m.uw),t.Y36(m.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["select-visitor-popup"]],features:[t.qOj],decls:27,vars:23,consts:[[1,"flex","flex-col","flex-auto","md:w-auto","lg:min-w-200","-m-6","md:max-w-160"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],["transloco","master.selectCustomer",1,"text-lg","font-medium"],["mat-icon-button","",3,"click"],[1,"icon-size-7","text-white",3,"svgIcon"],[1,"max-h-screen-80","max-w-screen-80","px-6","pt-6","pb-0","space-y-6","overflow-y-auto","bg-slate-100"],[1,"bg-card","rounded-md","p-6","gap-5","shadow","flex","flex-col","h-full"],[1,"pb-2","text-lg","font-semibold"],[3,"ngModel","disabled","ngModelChange"],[3,"ngModel","placeholderLabel","noEntriesFoundLabel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"flex","space-x-2","px-10","py-5","justify-end"],[1,"flex","flex-row","justify-start","space-x-4"],["mat-button","",3,"click"],["transloco","close",1,"text-base","leading-6","font-medium","cursor-pointer"],["mat-flat-button","",1,"w-min",3,"color","click"],["transloco","master.proceedCheckIn"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return i.onCancel()}),t._UZ(4,"mat-icon",4),t.qZA()(),t.TgZ(5,"div",5)(6,"div",6)(7,"mat-label",7),t._uU(8),t.ALo(9,"transloco"),t.qZA(),t.TgZ(10,"mat-form-field")(11,"mat-select",8),t.NdJ("ngModelChange",function(o){return i.selectedVisitor=o}),t.TgZ(12,"mat-option")(13,"ngx-mat-select-search",9),t.NdJ("ngModelChange",function(o){return i.search=o}),t.ALo(14,"transloco"),t.ALo(15,"transloco"),t.qZA()(),t.YNc(16,xt,2,3,"mat-option",10),t.ALo(17,"filter"),t.TgZ(18,"mat-option",11),t._uU(19),t.ALo(20,"transloco"),t.qZA()()()()(),t.TgZ(21,"div",12)(22,"div",13)(23,"button",14),t.NdJ("click",function(){return i.onCancel()}),t._UZ(24,"label",15),t.qZA(),t.TgZ(25,"button",16),t.NdJ("click",function(){return i.onProceed()}),t._UZ(26,"label",17),t.qZA()()()()),2&e&&(t.xp6(4),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(4),t.hij(" ",t.lcZ(9,11,"searchByCitizenNumberOrGuestName")," "),t.xp6(3),t.Q6J("ngModel",i.selectedVisitor)("disabled",i.isLoading),t.xp6(2),t.s9C("placeholderLabel",t.lcZ(14,13,"search")),t.s9C("noEntriesFoundLabel",t.lcZ(15,15,"no_data")),t.Q6J("ngModel",i.search),t.xp6(3),t.Q6J("ngForOf",t.Dn7(17,17,i.listVisitor,"name",i.search)),t.xp6(2),t.Q6J("value",null),t.xp6(1),t.hij(" ",t.lcZ(20,21,"master.addNewCustomer")," "),t.xp6(6),t.Q6J("color","primary"))},dependencies:[I.KE,I.hX,g.lW,g.RK,C.Hw,b.JJ,b.On,u.KI,p.sg,V.gD,bt.ey,P.nu,u.Ot,Ct.g],encapsulation:2}),n})();function vt(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,o=t.oxw();return t.KtG(o.onClickCheckOut(a.ticketHauntId))}),t._UZ(1,"mat-icon",36),t._uU(2),t.qZA()}2&n&&(t.xp6(2),t.hij(" ","Check-out"," "))}const B=function(n){return{"background-color":n}};function It(n,l){if(1&n){const e=t.EpF();t.TgZ(0,"tr",25),t.NdJ("dblclick",function(){const o=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.onClickView(o.ticketHauntId))}),t.TgZ(1,"td")(2,"span",26)(3,"button",27)(4,"mat-icon"),t._uU(5," more_vert "),t.qZA(),t.TgZ(6,"mat-menu",null,28),t.ynx(8),t.TgZ(9,"button",29),t.NdJ("click",function(){const o=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.onClickView(o.ticketHauntId))}),t._UZ(10,"mat-icon",30),t._uU(11),t.ALo(12,"transloco"),t.qZA(),t.YNc(13,vt,3,1,"button",31),t.BQk(),t.qZA()()()(),t.TgZ(14,"td")(15,"div",32),t._uU(16),t.qZA()(),t.TgZ(17,"td",33),t._uU(18),t.qZA(),t.TgZ(19,"td",33),t._uU(20),t.qZA(),t.TgZ(21,"td",33),t._uU(22),t.qZA(),t.TgZ(23,"td",33),t._uU(24),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.ALo(27,"date"),t.qZA(),t.TgZ(28,"td"),t._uU(29),t.ALo(30,"date"),t.qZA(),t.TgZ(31,"td")(32,"div",34),t._UZ(33,"div",35),t.TgZ(34,"span"),t._uU(35),t.ALo(36,"transloco"),t.qZA()()()()}if(2&n){const e=l.$implicit,i=l.index,a=t.MAs(7);t.oxw();const o=t.MAs(25);t.Q6J("ngStyle",t.VKq(27,B,e.statusBackgroundColor)),t.xp6(3),t.Q6J("matMenuTriggerFor",a),t.xp6(8),t.hij(" ",t.lcZ(12,17,"view")," "),t.xp6(2),t.Q6J("ngIf","STATUS_CHECKOUT"!==e.statusId),t.xp6(3),t.hij("",(o.nzPageIndex-1)*o.nzPageSize+i+1," "),t.xp6(1),t.Q6J("matTooltip",e.fullName),t.xp6(1),t.hij(" ",e.fullName," "),t.xp6(1),t.Q6J("matTooltip",e.citizenNumber),t.xp6(1),t.hij(" ",e.citizenNumber," "),t.xp6(1),t.Q6J("matTooltip",e.companyName),t.xp6(1),t.hij(" ",e.companyName," "),t.xp6(1),t.Q6J("matTooltip",e.apartmentCode),t.xp6(1),t.hij(" ",e.apartmentCode," "),t.xp6(2),t.hij(" ",t.xi3(27,19,e.arrivalTime,"dd/MM/yyyy HH:mm")," "),t.xp6(3),t.hij(" ",t.xi3(30,22,e.departureTime,"dd/MM/yyyy HH:mm")," "),t.xp6(4),t.Q6J("ngStyle",t.VKq(29,B,e.statusColor)),t.xp6(2),t.Oqu(t.lcZ(36,25,e.statusName))}}const _t=[{path:"visitor-customers",component:G,children:[{path:"",component:(()=>{class n{constructor(e,i,a,o,c,S){this._ticketHauntService=e,this._translocoService=i,this._router=a,this._activationRoute=o,this._outSideCustomerService=c,this._matDialog=S,this.actionEnum="new",this._unsubscribeAll=new h.x,this._debounce=new h.x,this.isLoading=!1,this.filter={textSearch:null,startDate:L()().startOf("week").toISOString(),endDate:L()().endOf("week").toISOString(),status:null},this.listVisitor=[],this.listTicketHaunt=[],this.visitorStatus=[]}ngOnInit(){this.getAllTicketHaunts(),this.getStatuses(),this.getVisitor(),this._debounce.pipe((0,$.b)(300),(0,r.R)(this._unsubscribeAll)).subscribe(()=>{this.getAllTicketHaunts()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}getAllTicketHaunts(){this.isLoading=!0,this._ticketHauntService.getAll(this.filter).pipe((0,x.x)(()=>this.isLoading=!1),(0,r.R)(this._unsubscribeAll)).subscribe(({data:e})=>{e&&(this.listTicketHaunt=e)})}getVisitor(){this.isLoading=!0,this._outSideCustomerService.getAll({isUse:!0}).pipe((0,r.R)(this._unsubscribeAll)).subscribe(({data:e})=>{this.listVisitor=e.map(i=>({id:i.outsideCustomerId,name:i.citizenNumber,description:i.fullName})),this.isLoading=!1})}getStatuses(){this._ticketHauntService.getVisitorStatus().pipe((0,r.R)(this._unsubscribeAll)).subscribe(({data:e})=>{this.visitorStatus=e})}refreshData(){this.getAllTicketHaunts()}onSearch(){this._debounce.next()}onClickCheckIn(){this._matDialog.open(Tt,{disableClose:!0,data:{listVisitor:this.listVisitor}}).afterClosed().subscribe(i=>{this.getAllTicketHaunts()})}onClickView(e){this._matDialog.open(A,{disableClose:!0,data:{ticketHauntId:e,action:"view"}}).afterClosed().subscribe(a=>{this.getAllTicketHaunts()})}onClickCheckOut(e){this._matDialog.open(A,{disableClose:!0,data:{ticketHauntId:e,action:"check-out"}}).afterClosed().subscribe(a=>{this.getAllTicketHaunts()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(U),t.Y36(u.Vn),t.Y36(v.F0),t.Y36(v.gz),t.Y36(j.H),t.Y36(m.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["ticket-haunt-list"]],decls:57,vars:47,consts:[[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-col"],[1,"flex","justify-between","items-center","bg-card","border-b","dark:bg-transparent","px-6","sm:py-5","md:px-8","gap-8"],[1,"leading-none","text-3xl","font-extrabold","tracking-tight"],[1,"space-x-4","flex","items-center"],["mat-flat-button","",1,"w-min",3,"color","click"],[1,"mr-2",3,"svgIcon"],["transloco","Check in"],["mat-icon-button","",3,"matTooltip","click"],["svgIcon","heroicons_outline:arrow-path",1,"text-slate-500"],[1,"bg-card","m-6","rounded-md","shadow"],[1,"p-6","space-y-6"],[1,"flex-col","flex","sm:flex-row","sm:justify-between"],[1,"flex","flex-col","w-full","h-full","space-y-6"],[1,"flex","gap-4"],["label","searchByCitizenNumberOrGuestName",1,"flex-1",3,"model","isDisableLength","placeholder","modelChange","keyup"],["type","daterangepicker","label","vime.times",1,"min-w-64",3,"start","end","startChange","endChange"],["label","status",1,"flex-1",3,"listData","model","modelChange"],[1,"border-b","w-full"],["nzShowSizeChanger","","nzBordered","true",3,"nzLoading","nzData"],["basicTable",""],["nzAlign","center","nzWidth","70px"],["nzWidth","200px"],["nzWidth","150px"],["class","hover:cursor-pointer",3,"ngStyle","dblclick",4,"ngFor","ngForOf"],[1,"hover:cursor-pointer",3,"ngStyle","dblclick"],[1,"items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],["headerMenu",""],["mat-menu-item","",3,"click"],["svgIcon","heroicons_outline:eye"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"h-full","flex","justify-center","items-center"],[1,"w-50","truncate","text-ellipsis",3,"matTooltip"],[1,"flex","items-center"],[1,"w-2","h-2","rounded-full","mr-2",3,"ngStyle"],["svgIcon","heroicons_outline:x-circle",1,"text-red-500"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.ALo(5,"transloco"),t.qZA(),t.TgZ(6,"div",4)(7,"button",5),t.NdJ("click",function(){return i.onClickCheckIn()}),t._UZ(8,"mat-icon",6)(9,"label",7),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return i.refreshData()}),t.ALo(11,"transloco"),t._UZ(12,"mat-icon",9),t.qZA()()()(),t.TgZ(13,"div",10)(14,"div",11)(15,"div",12)(16,"div",13)(17,"div",14)(18,"cm-input",15),t.NdJ("modelChange",function(o){return i.filter.textSearch=o})("keyup",function(){return i.onSearch()}),t.ALo(19,"transloco"),t.qZA(),t.TgZ(20,"cm-input",16),t.NdJ("startChange",function(o){return i.filter.startDate=o})("endChange",function(o){return i.filter.endDate=o})("startChange",function(){return i.onSearch()})("endChange",function(){return i.onSearch()}),t.qZA(),t.TgZ(21,"cm-select",17),t.NdJ("modelChange",function(o){return i.filter.status=o})("modelChange",function(){return i.onSearch()}),t.qZA()(),t._UZ(22,"div",18),t.qZA()(),t.TgZ(23,"div")(24,"nz-table",19,20)(26,"thead")(27,"tr")(28,"th",21),t._uU(29),t.ALo(30,"transloco"),t.qZA(),t.TgZ(31,"th",21),t._uU(32),t.ALo(33,"transloco"),t.qZA(),t.TgZ(34,"th",22),t._uU(35),t.ALo(36,"transloco"),t.qZA(),t.TgZ(37,"th",22),t._uU(38),t.ALo(39,"transloco"),t.qZA(),t.TgZ(40,"th",22),t._uU(41),t.ALo(42,"transloco"),t.qZA(),t.TgZ(43,"th",22),t._uU(44),t.ALo(45,"transloco"),t.qZA(),t.TgZ(46,"th",22),t._uU(47),t.ALo(48,"transloco"),t.qZA(),t.TgZ(49,"th",22),t._uU(50),t.ALo(51,"transloco"),t.qZA(),t.TgZ(52,"th",23),t._uU(53),t.ALo(54,"transloco"),t.qZA()()(),t.TgZ(55,"tbody"),t.YNc(56,It,37,31,"tr",24),t.qZA()()()()()()),2&e){const a=t.MAs(25);t.xp6(4),t.hij("",t.lcZ(5,23,"nav.visitorCustomers")," "),t.xp6(3),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","add"),t.xp6(2),t.s9C("matTooltip",t.lcZ(11,25,"com.refresh")),t.xp6(8),t.s9C("placeholder",t.lcZ(19,27,"plholder.enterCustomerNameOrCitizenNumber")),t.Q6J("model",i.filter.textSearch)("isDisableLength",!0),t.xp6(2),t.Q6J("start",i.filter.startDate)("end",i.filter.endDate),t.xp6(1),t.Q6J("listData",i.visitorStatus)("model",i.filter.status),t.xp6(3),t.Q6J("nzLoading",i.isLoading)("nzData",i.listTicketHaunt),t.xp6(5),t.Oqu(t.lcZ(30,29,"master.function")),t.xp6(3),t.Oqu(t.lcZ(33,31,"master.no")),t.xp6(3),t.Oqu(t.lcZ(36,33,"master.fullName")),t.xp6(3),t.Oqu(t.lcZ(39,35,"master.citizenNumber")),t.xp6(3),t.Oqu(t.lcZ(42,37,"master.company")),t.xp6(3),t.Oqu(t.lcZ(45,39,"master.apartment")),t.xp6(3),t.Oqu(t.lcZ(48,41,"master.arriveTime")),t.xp6(3),t.Oqu(t.lcZ(51,43,"master.departTime")),t.xp6(3),t.Oqu(t.lcZ(54,45,"status")),t.xp6(3),t.Q6J("ngForOf",a.data)}},dependencies:[d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,d.UX,g.lW,g.RK,C.Hw,F.gM,u.KI,p.sg,p.O5,p.PC,O.f,D.W,T.VK,T.OP,T.p6,u.Ot,p.uU],encapsulation:2}),n})()}]}],kt=new t.OlP("huh"),Zt=window.MauiInterop;let yt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[{provide:Window,useValue:window},{provide:kt,useValue:Zt},{provide:m.WI,useValue:{}},{provide:m.so,useValue:{}},{provide:N.u7,useValue:N.iF}],imports:[v.Bz.forChild(_t),I.lN,M.c,Q.p9,d.HQ,g.ot,C.Ps,F.AV,W.vO,q.qw,b.u5,u.y4,w.Gb,K.Tm,p.ez,R.rP,E.c,Y.Nh,C.Ps,T.Tx,V.LD,P.Co,y.Fk]}),n})()}}]);